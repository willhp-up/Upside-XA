<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>XA â€” Command Centre | Upside</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&family=Instrument+Serif:ital@0;1&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
:root{--bg0:#04060a;--bg1:#090c14;--bg2:#0e1220;--bg3:#161c2e;--bg4:#1e2640;--fg:#e4e8f4;--fg2:#b4bcd4;--fg3:#7580a0;--fg4:#4a5270;--border:rgba(120,140,200,.08);--border2:rgba(120,140,200,.16);--g:#00e676;--g2:#69f0ae;--r:#ff3d71;--y:#ffc107;--b:#40c4ff;--p:#b388ff;--mono:'JetBrains Mono','Fira Code','Consolas',monospace;--sans:'IBM Plex Sans',-apple-system,BlinkMacSystemFont,sans-serif;--serif:'Instrument Serif',Georgia,serif}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}html,body,#root{height:100%}
body{background:var(--bg0);color:var(--fg);font-family:var(--sans);-webkit-font-smoothing:antialiased}
::-webkit-scrollbar{width:4px;height:4px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--bg4);border-radius:2px}
input,textarea,select{font-family:inherit}input:focus,textarea:focus,select:focus{outline:none;border-color:var(--g)!important}button{font-family:inherit}
@keyframes fadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
@keyframes glow{0%,100%{box-shadow:0 0 8px var(--g)}50%{box-shadow:0 0 20px var(--g)}}
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const{useState,useMemo,useCallback,useEffect,useRef}=React;

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STORAGE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const LS={get(k){try{return JSON.parse(localStorage.getItem(k))}catch{return null}},set(k,v){localStorage.setItem(k,JSON.stringify(v))}};
function download(content,filename,mime='text/csv'){const b=new Blob([content],{type:mime});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download=filename;a.click();URL.revokeObjectURL(u)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCENARIO ENGINE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const SCENARIOS=[
  {id:"db",label:"Deep Bear",color:"#ef4444",bp:5},
  {id:"b",label:"Bear",color:"#f97316",bp:10},
  {id:"mb",label:"Mild Bear",color:"#eab308",bp:15},
  {id:"base",label:"Base",color:"#6366f1",bp:35},
  {id:"mbu",label:"Mild Bull",color:"#22d3ee",bp:20},
  {id:"bu",label:"Bull",color:"#10b981",bp:10},
  {id:"dbu",label:"Deep Bull",color:"#06d6a0",bp:5},
];

function runEngine(stock,driverMap,globalDrivers){
  if(!stock.prices||stock.prices.length!==7)return null;
  const mapped=driverMap.filter(m=>m.active!==false);
  const tw=mapped.reduce((s,m)=>s+m.weight,0)||1;
  const bp=SCENARIOS.map(s=>s.bp);
  const sp=bp.map((b,si)=>{
    const dir=si-3;let ms=0;
    mapped.forEach(m=>{
      const gd=globalDrivers.find(g=>g.id===m.driverId);
      const sig=gd?gd.signal:0;
      const sens=stock.sens?.[m.driverId]||0;
      ms+=(m.weight/tw)*sig*sens*dir*0.15;
    });
    return Math.max(1,b*(1+ms));
  });
  const tot=sp.reduce((s,p)=>s+p,0);
  const pr=sp.map(p=>(p/tot)*100);
  const ev=pr.reduce((s,p,i)=>s+(p/100)*stock.prices[i],0);
  const c=stock.currentPrice||stock.prices[3];
  const rr=c>0?((ev-c)/c)*100:0;
  const buw=pr.slice(4).reduce((s,p,i)=>s+p*Math.abs(stock.prices[i+4]-ev),0);
  const bew=pr.slice(0,3).reduce((s,p,i)=>s+p*Math.abs(stock.prices[i]-ev),0);
  const skew=bew>0?buw/bew:2;
  let vd="NEUTRAL";
  if(rr>15&&skew>1.2)vd="STRONG LONG";
  else if(rr>8&&skew>0.8)vd="LONG";
  else if(rr<-15&&skew<0.6)vd="STRONG SHORT";
  else if(rr<-8&&skew<0.8)vd="SHORT";
  let tier="Watchlist";
  if(Math.abs(rr)>15)tier="Core";
  else if(Math.abs(rr)>8)tier="Satellite";
  return{pr,ev,rr,skew,vd,tier};
}

const fmt=(v,t)=>{if(v===null||v===undefined||isNaN(v))return'â€”';if(t==='pct')return`${v>=0?'+':''}${v.toFixed(1)}%`;if(t==='ratio')return`${v.toFixed(1)}x`;return`${v.toFixed(1)}`};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• OPERATOR REGISTRY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const OPERATORS = [
  {
    id:"tig", name:"Tig", fullName:"Kris 'Tig' Paronto", teamId:"travel",
    team:"Travel", color:"#00e676", icon:"âœˆ", file:"tig-v2.html",
    desc:"K-Shape Travel Divergence",
    driverMap:[
      {driverId:"kshape",weight:25},{driverId:"rates_tig",weight:20},{driverId:"oil_tig",weight:20},
      {driverId:"consumer_tig",weight:15},{driverId:"btravel",weight:10},{driverId:"premium",weight:10},
    ],
    drivers:[
      {id:"kshape",label:"K-Shape Divergence",signal:0.7},
      {id:"rates_tig",label:"Interest Rates",signal:-0.3},
      {id:"oil_tig",label:"Oil Price Trajectory",signal:0.2},
      {id:"consumer_tig",label:"Consumer Confidence",signal:0.4},
      {id:"btravel",label:"Business Travel Shift",signal:0.5},
      {id:"premium",label:"Premiumisation",signal:0.6},
    ],
    stocks:[
      {ticker:"NAS.OL",name:"Norwegian Air",verdict:"long",currentPrice:12.8,prices:[6.5,8.2,10.5,14.8,17.5,21,26],sens:{kshape:.8,rates_tig:-.6,oil_tig:-.5,consumer_tig:.7,btravel:.3,premium:.9}},
      {ticker:"IAG.L",name:"IAG (BA/Iberia)",verdict:"long",currentPrice:2.15,prices:[1.1,1.45,1.8,2.5,2.95,3.5,4.2],sens:{kshape:.7,rates_tig:-.4,oil_tig:-.6,consumer_tig:.6,btravel:.7,premium:.8}},
      {ticker:"EZJ.L",name:"easyJet",verdict:"long",currentPrice:5.4,prices:[2.8,3.6,4.5,6.2,7.4,8.8,11],sens:{kshape:.6,rates_tig:-.5,oil_tig:-.7,consumer_tig:.5,btravel:.2,premium:.7}},
      {ticker:"THYAO.IS",name:"Turkish Airlines",verdict:"long",currentPrice:282,prices:[140,185,230,320,380,450,560],sens:{kshape:.5,rates_tig:-.3,oil_tig:-.4,consumer_tig:.4,btravel:.8,premium:.7}},
      {ticker:"QAN.AX",name:"Qantas",verdict:"long",currentPrice:8.9,prices:[4.5,5.8,7.2,10.2,12,14.5,18],sens:{kshape:.6,rates_tig:-.3,oil_tig:-.5,consumer_tig:.5,btravel:.6,premium:.8}},
      {ticker:"MAR",name:"Marriott",verdict:"long",currentPrice:265,prices:[160,195,230,290,330,380,440],sens:{kshape:.7,rates_tig:-.2,oil_tig:-.1,consumer_tig:.8,btravel:.6,premium:.9}},
      {ticker:"IHG.L",name:"IHG",verdict:"long",currentPrice:88.5,prices:[52,64,76,98,112,130,155],sens:{kshape:.7,rates_tig:-.2,oil_tig:-.1,consumer_tig:.7,btravel:.5,premium:.8}},
      {ticker:"BKNG",name:"Booking Holdings",verdict:"long",currentPrice:4450,prices:[2800,3400,3900,4800,5400,6200,7500],sens:{kshape:.5,rates_tig:-.2,oil_tig:-.1,consumer_tig:.6,btravel:.4,premium:.7}},
      {ticker:"ZURN.SW",name:"Zurich Airport",verdict:"long",currentPrice:205,prices:[130,155,180,225,260,300,360],sens:{kshape:.4,rates_tig:-.2,oil_tig:-.1,consumer_tig:.5,btravel:.3,premium:.6}},
      {ticker:"WIZZ.L",name:"Wizz Air",verdict:"short",currentPrice:18.5,prices:[6,9.5,13,17,22,28,35],sens:{kshape:-.8,rates_tig:.5,oil_tig:.7,consumer_tig:-.6,btravel:-.2,premium:-.9}},
      {ticker:"RYA.L",name:"Ryanair",verdict:"short",currentPrice:18.8,prices:[8.5,12,15.5,19.5,23,27,32],sens:{kshape:-.6,rates_tig:.4,oil_tig:.6,consumer_tig:-.4,btravel:-.1,premium:-.7}},
      {ticker:"AF.PA",name:"Air France-KLM",verdict:"short",currentPrice:8.2,prices:[2.5,4,5.8,7.8,10.5,13,16],sens:{kshape:-.7,rates_tig:.6,oil_tig:.5,consumer_tig:-.5,btravel:-.3,premium:-.6}},
      {ticker:"LHA.DE",name:"Lufthansa",verdict:"short",currentPrice:6.5,prices:[2,3.2,4.6,6.2,8,10,13],sens:{kshape:-.6,rates_tig:.5,oil_tig:.4,consumer_tig:-.4,btravel:-.4,premium:-.5}},
      {ticker:"WH",name:"Wyndham",verdict:"short",currentPrice:82,prices:[45,55,68,80,95,110,130],sens:{kshape:-.6,rates_tig:.3,oil_tig:.2,consumer_tig:-.7,btravel:-.3,premium:-.8}},
      {ticker:"FRA.DE",name:"Fraport",verdict:"short",currentPrice:52,prices:[28,36,44,54,62,72,85],sens:{kshape:-.4,rates_tig:.4,oil_tig:.2,consumer_tig:-.3,btravel:-.2,premium:-.5}},
    ]
  },
  {
    id:"rone", name:"Rone", fullName:"Mark 'Oz' Geist", teamId:"defence",
    team:"Defence", color:"#40c4ff", icon:"ğŸ›¡", file:"rone-v2.html",
    desc:"NATO Rearmament Supercycle",
    driverMap:[
      {driverId:"nato",weight:30},{driverId:"geopol",weight:25},{driverId:"autonomy",weight:15},
      {driverId:"rates_rone",weight:10},{driverId:"supply",weight:10},{driverId:"oil_rone",weight:10},
    ],
    drivers:[
      {id:"nato",label:"NATO / Defence Spend",signal:0.8},
      {id:"geopol",label:"Geopolitical Escalation",signal:0.5},
      {id:"autonomy",label:"EU Strategic Autonomy",signal:0.6},
      {id:"rates_rone",label:"Interest Rates",signal:-0.3},
      {id:"supply",label:"Supply Chain Capacity",signal:0.3},
      {id:"oil_rone",label:"Oil Price",signal:0.2},
    ],
    stocks:[
      {ticker:"BA.L",name:"BAE Systems",verdict:"long",currentPrice:2031,prices:[1400,1650,1850,2200,2450,2750,3200],sens:{nato:.8,geopol:.7,autonomy:.5,rates_rone:-.3,supply:-.2,oil_rone:-.1}},
      {ticker:"RHM.DE",name:"Rheinmetall",verdict:"long",currentPrice:1609,prices:[900,1100,1350,1750,2050,2400,3000],sens:{nato:.9,geopol:.9,autonomy:.7,rates_rone:-.4,supply:-.6,oil_rone:-.1}},
      {ticker:"SAAB-B.ST",name:"Saab",verdict:"long",currentPrice:657,prices:[380,470,560,720,840,980,1200],sens:{nato:.8,geopol:.8,autonomy:.6,rates_rone:-.2,supply:-.3,oil_rone:-.1}},
      {ticker:"HO.PA",name:"Thales",verdict:"long",currentPrice:245,prices:[165,195,220,270,310,360,430],sens:{nato:.7,geopol:.6,autonomy:.7,rates_rone:-.2,supply:-.2,oil_rone:-.1}},
      {ticker:"LDO.MI",name:"Leonardo",verdict:"long",currentPrice:54,prices:[30,38,46,60,70,82,100],sens:{nato:.7,geopol:.6,autonomy:.6,rates_rone:-.5,supply:-.3,oil_rone:-.1}},
      {ticker:"AIR.PA",name:"Airbus D&S",verdict:"long",currentPrice:192,prices:[130,155,175,210,240,275,330],sens:{nato:.7,geopol:.5,autonomy:.8,rates_rone:-.3,supply:-.4,oil_rone:-.1}},
      {ticker:"RR.L",name:"Rolls-Royce",verdict:"long",currentPrice:1271,prices:[800,950,1100,1400,1600,1850,2200],sens:{nato:.5,geopol:.4,autonomy:.4,rates_rone:-.3,supply:-.3,oil_rone:-.1}},
      {ticker:"QQ.L",name:"QinetiQ",verdict:"long",currentPrice:474,prices:[320,380,430,520,580,660,780],sens:{nato:.6,geopol:.4,autonomy:.3,rates_rone:-.2,supply:-.1,oil_rone:0}},
      {ticker:"LMT",name:"Lockheed Martin",verdict:"short",currentPrice:653,prices:[420,500,570,640,720,810,950],sens:{nato:.3,geopol:.4,autonomy:-.7,rates_rone:-.2,supply:-.1,oil_rone:0}},
      {ticker:"GD",name:"General Dynamics",verdict:"short",currentPrice:360,prices:[240,280,320,365,410,460,530],sens:{nato:.2,geopol:.3,autonomy:-.6,rates_rone:-.3,supply:-.1,oil_rone:0}},
      {ticker:"HAG.DE",name:"Hensoldt",verdict:"short",currentPrice:81,prices:[40,52,65,78,95,115,145],sens:{nato:.5,geopol:.4,autonomy:.3,rates_rone:-.5,supply:-.6,oil_rone:0}},
      {ticker:"AVON.L",name:"Avon Protection",verdict:"short",currentPrice:1050,prices:[600,750,900,1050,1200,1400,1700],sens:{nato:.3,geopol:.3,autonomy:.1,rates_rone:-.3,supply:-.4,oil_rone:0}},
      {ticker:"CHG.L",name:"Chemring",verdict:"short",currentPrice:500,prices:[320,380,440,510,580,660,780],sens:{nato:.4,geopol:.3,autonomy:.2,rates_rone:-.3,supply:-.5,oil_rone:0}},
    ]
  },
  {
    id:"tanto", name:"Tanto", fullName:"Kris 'Tanto' Paronto", teamId:"energy",
    team:"Energy & Commodities", color:"#f59e0b", icon:"ğŸ›¢", file:"tanto-v2.html",
    desc:"Energy Transition Divergence",
    driverMap:[
      {driverId:"t_oilprice",weight:30},{driverId:"t_opec",weight:20},{driverId:"t_transition",weight:15},
      {driverId:"t_rates",weight:10},{driverId:"t_china",weight:15},{driverId:"t_capex",weight:10},
    ],
    drivers:[
      {id:"t_oilprice",label:"Oil Price Trajectory",signal:-0.2},
      {id:"t_opec",label:"OPEC+ Discipline",signal:0.3},
      {id:"t_transition",label:"Energy Transition",signal:0.4},
      {id:"t_rates",label:"Interest Rates",signal:-0.3},
      {id:"t_china",label:"China Demand",signal:-0.2},
      {id:"t_capex",label:"Capex Discipline",signal:0.5},
    ],
    stocks:[
      {ticker:"SHEL",name:"Shell",verdict:"long",currentPrice:78,prices:[48,58,68,85,98,115,140],sens:{t_oilprice:.7,t_opec:.6,t_transition:-.3,t_rates:-.2,t_china:.5,t_capex:.7}},
      {ticker:"XOM",name:"ExxonMobil",verdict:"long",currentPrice:149,prices:[95,115,132,160,182,210,250],sens:{t_oilprice:.8,t_opec:.5,t_transition:-.4,t_rates:-.1,t_china:.4,t_capex:.8}},
      {ticker:"CVX",name:"Chevron",verdict:"long",currentPrice:184,prices:[115,140,162,195,225,260,310],sens:{t_oilprice:.7,t_opec:.5,t_transition:-.3,t_rates:-.2,t_china:.4,t_capex:.9}},
      {ticker:"TTE",name:"TotalEnergies",verdict:"long",currentPrice:77,prices:[45,55,66,82,96,115,140],sens:{t_oilprice:.6,t_opec:.5,t_transition:.2,t_rates:-.2,t_china:.5,t_capex:.6}},
      {ticker:"EQNR",name:"Equinor",verdict:"long",currentPrice:28,prices:[16,20,24,30,36,43,52],sens:{t_oilprice:.8,t_opec:.6,t_transition:.3,t_rates:-.1,t_china:.3,t_capex:.5}},
      {ticker:"CNQ",name:"Canadian Natural",verdict:"long",currentPrice:28,prices:[15,19,23,30,36,44,55],sens:{t_oilprice:.9,t_opec:.4,t_transition:-.5,t_rates:-.3,t_china:.3,t_capex:.8}},
      {ticker:"SU",name:"Suncor Energy",verdict:"long",currentPrice:55,prices:[32,39,47,59,70,84,105],sens:{t_oilprice:.8,t_opec:.4,t_transition:-.4,t_rates:-.2,t_china:.3,t_capex:.7}},
      {ticker:"VET",name:"Vermilion Energy",verdict:"long",currentPrice:9.5,prices:[4,5.5,7.5,11,14,18,24],sens:{t_oilprice:.9,t_opec:.5,t_transition:-.6,t_rates:-.4,t_china:.4,t_capex:.6}},
      {ticker:"BP",name:"BP",verdict:"short",currentPrice:39,prices:[18,24,31,38,48,58,72],sens:{t_oilprice:-.5,t_opec:-.4,t_transition:.3,t_rates:.3,t_china:-.3,t_capex:-.7}},
      {ticker:"OXY",name:"Occidental",verdict:"short",currentPrice:46,prices:[22,30,38,48,56,66,80],sens:{t_oilprice:-.6,t_opec:-.3,t_transition:-.2,t_rates:.2,t_china:-.2,t_capex:-.8}},
      {ticker:"RIG",name:"Transocean",verdict:"short",currentPrice:3.8,prices:[1,1.8,2.8,4,5.5,7.5,10],sens:{t_oilprice:-.8,t_opec:-.5,t_transition:-.6,t_rates:.5,t_china:-.4,t_capex:-.5}},
      {ticker:"HAL",name:"Halliburton",verdict:"short",currentPrice:24,prices:[12,16,20,25,30,36,44],sens:{t_oilprice:-.6,t_opec:-.4,t_transition:-.3,t_rates:.2,t_china:-.3,t_capex:-.4}},
      {ticker:"PBR",name:"Petrobras",verdict:"short",currentPrice:15,prices:[7,9.5,12.5,15.5,19,23,28],sens:{t_oilprice:-.5,t_opec:-.3,t_transition:-.1,t_rates:.4,t_china:-.5,t_capex:-.3}},
    ]
  },
  {
    id:"jack", name:"Jack", fullName:"Jack Silva", teamId:"semiconductors",
    team:"AI & Semiconductors", color:"#818cf8", icon:"ğŸ§ ", file:"jack-v2.html",
    desc:"AI Capex Supercycle",
    driverMap:[
      {driverId:"j_aicapex",weight:30},{driverId:"j_china",weight:20},{driverId:"j_rates",weight:15},
      {driverId:"j_consumer",weight:10},{driverId:"j_foundry",weight:15},{driverId:"j_regulation",weight:10},
    ],
    drivers:[
      {id:"j_aicapex",label:"AI Capex Momentum",signal:0.7},
      {id:"j_china",label:"China/Export Controls",signal:-0.3},
      {id:"j_rates",label:"Rates & Multiples",signal:-0.2},
      {id:"j_consumer",label:"Consumer Demand",signal:0.3},
      {id:"j_foundry",label:"Foundry/Supply Chain",signal:0.4},
      {id:"j_regulation",label:"AI Regulation Risk",signal:-0.1},
    ],
    stocks:[
      {ticker:"NVDA",name:"NVIDIA",verdict:"long",currentPrice:183,prices:[95,125,155,200,240,290,360],sens:{j_aicapex:.9,j_china:-.4,j_rates:-.3,j_consumer:.3,j_foundry:.6,j_regulation:-.4}},
      {ticker:"TSM",name:"TSMC",verdict:"long",currentPrice:366,prices:[200,260,320,400,475,560,680],sens:{j_aicapex:.7,j_china:-.6,j_rates:-.2,j_consumer:.4,j_foundry:.9,j_regulation:-.2}},
      {ticker:"AVGO",name:"Broadcom",verdict:"long",currentPrice:325,prices:[180,235,285,355,420,500,620],sens:{j_aicapex:.8,j_china:-.3,j_rates:-.3,j_consumer:.2,j_foundry:.5,j_regulation:-.3}},
      {ticker:"ASML",name:"ASML",verdict:"long",currentPrice:1407,prices:[800,1000,1200,1500,1750,2050,2500],sens:{j_aicapex:.6,j_china:-.5,j_rates:-.3,j_consumer:.2,j_foundry:.8,j_regulation:-.2}},
      {ticker:"AMAT",name:"Applied Materials",verdict:"long",currentPrice:180,prices:[105,130,158,195,230,275,340],sens:{j_aicapex:.5,j_china:-.5,j_rates:-.2,j_consumer:.3,j_foundry:.7,j_regulation:-.1}},
      {ticker:"MRVL",name:"Marvell Tech",verdict:"long",currentPrice:105,prices:[50,68,88,115,140,175,220],sens:{j_aicapex:.8,j_china:-.2,j_rates:-.4,j_consumer:.2,j_foundry:.4,j_regulation:-.3}},
      {ticker:"ALAB",name:"Astera Labs",verdict:"long",currentPrice:95,prices:[35,52,72,105,140,185,250],sens:{j_aicapex:.9,j_china:-.1,j_rates:-.5,j_consumer:.1,j_foundry:.5,j_regulation:-.2}},
      {ticker:"MU",name:"Micron",verdict:"long",currentPrice:98,prices:[52,68,82,108,130,160,200],sens:{j_aicapex:.7,j_china:-.3,j_rates:-.3,j_consumer:.5,j_foundry:.6,j_regulation:-.1}},
      {ticker:"AMD",name:"AMD",verdict:"short",currentPrice:207,prices:[100,135,175,215,260,310,380],sens:{j_aicapex:-.3,j_china:.2,j_rates:.2,j_consumer:-.2,j_foundry:-.3,j_regulation:.2}},
      {ticker:"INTC",name:"Intel",verdict:"short",currentPrice:24,prices:[10,14,19,25,32,40,52],sens:{j_aicapex:-.4,j_china:.3,j_rates:.3,j_consumer:-.1,j_foundry:-.6,j_regulation:.1}},
      {ticker:"QCOM",name:"Qualcomm",verdict:"short",currentPrice:168,prices:[90,120,148,175,205,240,285],sens:{j_aicapex:-.2,j_china:.4,j_rates:.2,j_consumer:-.4,j_foundry:-.2,j_regulation:.3}},
      {ticker:"ARM",name:"ARM Holdings",verdict:"short",currentPrice:172,prices:[80,110,145,180,220,270,340],sens:{j_aicapex:-.2,j_china:.1,j_rates:.3,j_consumer:-.3,j_foundry:-.2,j_regulation:.4}},
      {ticker:"SMCI",name:"Super Micro",verdict:"short",currentPrice:40,prices:[12,20,30,42,58,78,105],sens:{j_aicapex:-.5,j_china:.2,j_rates:.3,j_consumer:-.1,j_foundry:-.4,j_regulation:.3}},
    ]
  },
  {
    id:"boon", name:"Boon", fullName:"Dave 'Boon' Benton", teamId:"fintech",
    team:"Fintech & Payments", color:"#34d399", icon:"ğŸ’³", file:"boon-v2.html",
    desc:"Digital Payments Revolution",
    driverMap:[
      {driverId:"b_digital",weight:25},{driverId:"b_rates",weight:20},{driverId:"b_consumer",weight:20},
      {driverId:"b_regulation",weight:15},{driverId:"b_crypto",weight:10},{driverId:"b_em",weight:10},
    ],
    drivers:[
      {id:"b_digital",label:"Digital Payment Shift",signal:0.6},
      {id:"b_rates",label:"Rate Environment",signal:-0.3},
      {id:"b_consumer",label:"Consumer Spend",signal:0.3},
      {id:"b_regulation",label:"Regulatory/Cap Risk",signal:-0.4},
      {id:"b_crypto",label:"Crypto/DeFi Momentum",signal:0.2},
      {id:"b_em",label:"EM Fintech Growth",signal:0.5},
    ],
    stocks:[
      {ticker:"V",name:"Visa",verdict:"long",currentPrice:340,prices:[220,260,300,365,420,485,570],sens:{b_digital:.8,b_rates:-.1,b_consumer:.6,b_regulation:-.5,b_crypto:-.1,b_em:.5}},
      {ticker:"MA",name:"Mastercard",verdict:"long",currentPrice:518,prices:[340,400,465,555,640,740,870],sens:{b_digital:.8,b_rates:-.1,b_consumer:.6,b_regulation:-.5,b_crypto:-.1,b_em:.6}},
      {ticker:"ADYEN.AS",name:"Adyen",verdict:"long",currentPrice:1520,prices:[800,1050,1300,1650,1950,2350,2900],sens:{b_digital:.9,b_rates:-.2,b_consumer:.5,b_regulation:-.3,b_crypto:.2,b_em:.7}},
      {ticker:"SOFI",name:"SoFi Technologies",verdict:"long",currentPrice:19.7,prices:[8,12,16,22,28,36,48],sens:{b_digital:.6,b_rates:-.6,b_consumer:.4,b_regulation:-.2,b_crypto:.5,b_em:.3}},
      {ticker:"MELI",name:"MercadoLibre",verdict:"long",currentPrice:2050,prices:[1100,1400,1750,2200,2650,3200,4000],sens:{b_digital:.7,b_rates:-.3,b_consumer:.5,b_regulation:-.2,b_crypto:.4,b_em:.9}},
      {ticker:"COIN",name:"Coinbase",verdict:"long",currentPrice:265,prices:[100,155,215,290,380,500,680],sens:{b_digital:.3,b_rates:-.4,b_consumer:.2,b_regulation:-.3,b_crypto:.9,b_em:.2}},
      {ticker:"AFRM",name:"Affirm",verdict:"long",currentPrice:62,prices:[22,35,48,68,90,120,165],sens:{b_digital:.7,b_rates:-.7,b_consumer:.6,b_regulation:-.4,b_crypto:.3,b_em:.4}},
      {ticker:"NU",name:"Nu Holdings",verdict:"long",currentPrice:12.5,prices:[5.5,7.5,10,13.5,17,22,29],sens:{b_digital:.7,b_rates:-.4,b_consumer:.5,b_regulation:-.2,b_crypto:.3,b_em:.8}},
      {ticker:"PYPL",name:"PayPal",verdict:"short",currentPrice:40,prices:[18,25,33,42,52,64,80],sens:{b_digital:-.3,b_rates:.2,b_consumer:-.2,b_regulation:.3,b_crypto:-.1,b_em:-.2}},
      {ticker:"XYZ",name:"Block (Square)",verdict:"short",currentPrice:72,prices:[32,45,58,75,92,115,145],sens:{b_digital:-.2,b_rates:.1,b_consumer:-.3,b_regulation:.2,b_crypto:.4,b_em:-.1}},
      {ticker:"FIS",name:"Fidelity Nat'l Info",verdict:"short",currentPrice:78,prices:[45,55,66,80,92,108,128],sens:{b_digital:-.5,b_rates:.3,b_consumer:-.1,b_regulation:.4,b_crypto:-.2,b_em:-.3}},
      {ticker:"GPN",name:"Global Payments",verdict:"short",currentPrice:95,prices:[52,65,80,98,115,135,160],sens:{b_digital:-.5,b_rates:.3,b_consumer:-.2,b_regulation:.4,b_crypto:-.1,b_em:-.3}},
      {ticker:"WU",name:"Western Union",verdict:"short",currentPrice:11,prices:[5,6.5,8.5,11,14,17,21],sens:{b_digital:-.8,b_rates:.2,b_consumer:-.3,b_regulation:.3,b_crypto:-.2,b_em:-.7}},
    ]
  },
  {
    id:"oz", name:"Oz", fullName:"Mark 'Oz' Geist", teamId:"healthcare",
    team:"Healthcare & Biotech", color:"#f472b6", icon:"ğŸ§¬", file:"oz-v2.html",
    desc:"GLP-1 & Innovation Pipeline",
    driverMap:[
      {driverId:"o_glp1",weight:25},{driverId:"o_pipeline",weight:20},{driverId:"o_pricing",weight:20},
      {driverId:"o_rates",weight:10},{driverId:"o_ma",weight:15},{driverId:"o_aging",weight:10},
    ],
    drivers:[
      {id:"o_glp1",label:"GLP-1/Obesity Momentum",signal:0.6},
      {id:"o_pipeline",label:"Pipeline/FDA Catalysts",signal:0.4},
      {id:"o_pricing",label:"Drug Pricing Pressure",signal:-0.4},
      {id:"o_rates",label:"Rate Environment",signal:-0.2},
      {id:"o_ma",label:"M&A / Dealmaking",signal:0.3},
      {id:"o_aging",label:"Demographics/Aging",signal:0.5},
    ],
    stocks:[
      {ticker:"LLY",name:"Eli Lilly",verdict:"long",currentPrice:920,prices:[580,680,800,985,1150,1350,1600],sens:{o_glp1:.9,o_pipeline:.7,o_pricing:-.4,o_rates:-.2,o_ma:.3,o_aging:.6}},
      {ticker:"ISRG",name:"Intuitive Surgical",verdict:"long",currentPrice:580,prices:[340,410,500,625,740,880,1050],sens:{o_glp1:.2,o_pipeline:.5,o_pricing:-.2,o_rates:-.3,o_ma:.4,o_aging:.8}},
      {ticker:"VRTX",name:"Vertex Pharma",verdict:"long",currentPrice:455,prices:[280,340,400,490,570,670,800],sens:{o_glp1:.1,o_pipeline:.8,o_pricing:-.3,o_rates:-.2,o_ma:.5,o_aging:.4}},
      {ticker:"REGN",name:"Regeneron",verdict:"long",currentPrice:710,prices:[440,530,630,760,880,1030,1220],sens:{o_glp1:.2,o_pipeline:.7,o_pricing:-.3,o_rates:-.1,o_ma:.4,o_aging:.5}},
      {ticker:"TMO",name:"Thermo Fisher",verdict:"long",currentPrice:540,prices:[340,410,480,575,665,780,920],sens:{o_glp1:.3,o_pipeline:.4,o_pricing:-.1,o_rates:-.3,o_ma:.6,o_aging:.6}},
      {ticker:"DXCM",name:"DexCom",verdict:"long",currentPrice:82,prices:[38,52,68,90,115,145,185],sens:{o_glp1:.7,o_pipeline:.5,o_pricing:-.3,o_rates:-.4,o_ma:.3,o_aging:.7}},
      {ticker:"ARGX",name:"argenx",verdict:"long",currentPrice:680,prices:[350,450,570,730,880,1060,1300],sens:{o_glp1:.1,o_pipeline:.9,o_pricing:-.2,o_rates:-.3,o_ma:.6,o_aging:.3}},
      {ticker:"ALNY",name:"Alnylam Pharma",verdict:"long",currentPrice:265,prices:[130,175,225,290,355,430,530],sens:{o_glp1:.1,o_pipeline:.8,o_pricing:-.3,o_rates:-.3,o_ma:.5,o_aging:.4}},
      {ticker:"NVO",name:"Novo Nordisk",verdict:"short",currentPrice:50,prices:[25,32,40,52,65,82,105],sens:{o_glp1:-.4,o_pipeline:-.3,o_pricing:.5,o_rates:.2,o_ma:-.2,o_aging:-.1}},
      {ticker:"UNH",name:"UnitedHealth",verdict:"short",currentPrice:470,prices:[280,340,410,485,560,640,740],sens:{o_glp1:-.3,o_pipeline:-.1,o_pricing:.6,o_rates:.3,o_ma:-.2,o_aging:.3}},
      {ticker:"PFE",name:"Pfizer",verdict:"short",currentPrice:26,prices:[14,18,22,27,32,38,46],sens:{o_glp1:-.2,o_pipeline:-.4,o_pricing:.4,o_rates:.3,o_ma:-.3,o_aging:-.2}},
      {ticker:"MRNA",name:"Moderna",verdict:"short",currentPrice:32,prices:[12,18,25,34,48,68,95],sens:{o_glp1:-.1,o_pipeline:-.5,o_pricing:.3,o_rates:.4,o_ma:-.2,o_aging:-.3}},
      {ticker:"CVS",name:"CVS Health",verdict:"short",currentPrice:56,prices:[32,40,48,58,68,80,95],sens:{o_glp1:-.2,o_pipeline:-.1,o_pricing:.6,o_rates:.2,o_ma:-.3,o_aging:.2}},
    ]
  },
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAN ASIAN THEMATIC â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  {
    id:"ipm", name:"Ip Man", fullName:"Ip Man (è‘‰å•)", teamId:"panasian",
    team:"Pan Asian Thematic", color:"#ff6b35", icon:"ğŸ‰", file:"ipm-v1.html",
    desc:"15-5 Plan Â· CNY Appreciation Â· Capital Account Opening",
    driverMap:[
      {driverId:"ipm_cny",weight:25},{driverId:"ipm_155plan",weight:20},{driverId:"ipm_capital",weight:20},
      {driverId:"ipm_wmp",weight:15},{driverId:"ipm_consumer",weight:10},{driverId:"ipm_geopol",weight:10},
    ],
    drivers:[
      {id:"ipm_cny",label:"CNY Appreciation (7.20â†’6.00)",signal:0.6},
      {id:"ipm_155plan",label:"15-5 Plan Alignment",signal:0.7},
      {id:"ipm_capital",label:"Capital Account Opening",signal:0.5},
      {id:"ipm_wmp",label:"WMP â†’ Equity Reallocation",signal:0.4},
      {id:"ipm_consumer",label:"Consumer Recovery",signal:0.3},
      {id:"ipm_geopol",label:"Geopolitical Risk",signal:-0.3},
    ],
    stocks:[
      {ticker:"1801.HK",name:"Innovent Biologics",verdict:"long",currentPrice:84,prices:[42,55,68,92,112,138,175],sens:{ipm_cny:.6,ipm_155plan:.9,ipm_capital:.4,ipm_wmp:.5,ipm_consumer:.3,ipm_geopol:-.4}},
      {ticker:"2269.HK",name:"WuXi Biologics",verdict:"long",currentPrice:40.5,prices:[20,26,33,44,54,66,82],sens:{ipm_cny:.5,ipm_155plan:.8,ipm_capital:.5,ipm_wmp:.4,ipm_consumer:.2,ipm_geopol:-.6}},
      {ticker:"300760.SZ",name:"Mindray Medical",verdict:"long",currentPrice:186,prices:[105,130,158,205,245,295,360],sens:{ipm_cny:.4,ipm_155plan:.8,ipm_capital:.3,ipm_wmp:.5,ipm_consumer:.6,ipm_geopol:-.2}},
      {ticker:"1211.HK",name:"BYD",verdict:"long",currentPrice:90,prices:[48,60,75,98,120,148,185],sens:{ipm_cny:.7,ipm_155plan:.7,ipm_capital:.3,ipm_wmp:.4,ipm_consumer:.7,ipm_geopol:-.5}},
      {ticker:"3750.HK",name:"CATL",verdict:"long",currentPrice:532,prices:[290,360,445,575,680,810,1000],sens:{ipm_cny:.6,ipm_155plan:.9,ipm_capital:.4,ipm_wmp:.3,ipm_consumer:.2,ipm_geopol:-.3}},
      {ticker:"0700.HK",name:"Tencent",verdict:"long",currentPrice:533,prices:[310,380,460,575,680,800,960],sens:{ipm_cny:.5,ipm_155plan:.5,ipm_capital:.6,ipm_wmp:.7,ipm_consumer:.8,ipm_geopol:-.4}},
      {ticker:"9988.HK",name:"Alibaba",verdict:"long",currentPrice:155,prices:[82,105,130,170,210,260,325],sens:{ipm_cny:.5,ipm_155plan:.4,ipm_capital:.7,ipm_wmp:.6,ipm_consumer:.7,ipm_geopol:-.5}},
      {ticker:"3690.HK",name:"Meituan",verdict:"short",currentPrice:82,prices:[42,55,68,85,105,130,165],sens:{ipm_cny:-.2,ipm_155plan:-.3,ipm_capital:.2,ipm_wmp:.3,ipm_consumer:-.6,ipm_geopol:.2}},
      {ticker:"0175.HK",name:"Geely Auto",verdict:"short",currentPrice:16,prices:[6.5,9,12,15.5,19.5,24,30],sens:{ipm_cny:-.4,ipm_155plan:-.5,ipm_capital:.1,ipm_wmp:.2,ipm_consumer:-.4,ipm_geopol:.3}},
      {ticker:"601012.SH",name:"LONGi Green Energy",verdict:"short",currentPrice:18,prices:[6,9,13,17,22,28,36],sens:{ipm_cny:-.3,ipm_155plan:.2,ipm_capital:-.1,ipm_wmp:.1,ipm_consumer:-.2,ipm_geopol:.4}},
      {ticker:"2382.HK",name:"Sunny Optical",verdict:"short",currentPrice:65,prices:[28,38,50,63,78,96,120],sens:{ipm_cny:-.3,ipm_155plan:-.2,ipm_capital:.1,ipm_wmp:.2,ipm_consumer:-.5,ipm_geopol:.5}},
    ]
  },
  {
    id:"miu", name:"Miura", fullName:"Miura (ä¸‰æµ¦)", teamId:"panasian",
    team:"Pan Asian Thematic", color:"#e11d48", icon:"â›©ï¸", file:"miu-v1.html",
    desc:"JPY Appreciation Â· Foreign Inflows Â· Takaichi Admin Â· Defence Buildup",
    driverMap:[
      {driverId:"miu_jpy",weight:25},{driverId:"miu_inflows",weight:20},{driverId:"miu_admin",weight:20},
      {driverId:"miu_china",weight:15},{driverId:"miu_rates",weight:10},{driverId:"miu_defence",weight:10},
    ],
    drivers:[
      {id:"miu_jpy",label:"JPY Appreciation (150â†’125)",signal:0.6},
      {id:"miu_inflows",label:"Foreign Capital Inflows",signal:0.5},
      {id:"miu_admin",label:"Takaichi Admin Agenda",signal:0.5},
      {id:"miu_china",label:"China Hawkishness",signal:-0.3},
      {id:"miu_rates",label:"BOJ Rate Normalisation",signal:0.4},
      {id:"miu_defence",label:"Defence Spending Uplift",signal:0.6},
    ],
    stocks:[
      {ticker:"8306.T",name:"Mitsubishi UFJ",verdict:"long",currentPrice:2877,prices:[1600,2000,2450,3100,3650,4300,5200],sens:{miu_jpy:.7,miu_inflows:.8,miu_admin:.5,miu_china:-.2,miu_rates:.9,miu_defence:.1}},
      {ticker:"8035.T",name:"Tokyo Electron",verdict:"long",currentPrice:42150,prices:[22000,28000,35000,45000,55000,68000,85000],sens:{miu_jpy:.3,miu_inflows:.7,miu_admin:.4,miu_china:-.4,miu_rates:.2,miu_defence:.1}},
      {ticker:"7012.T",name:"Kawasaki Heavy",verdict:"long",currentPrice:16940,prices:[8500,11000,14000,18500,23000,29000,37000],sens:{miu_jpy:.3,miu_inflows:.4,miu_admin:.7,miu_china:.5,miu_rates:.1,miu_defence:.9}},
      {ticker:"7011.T",name:"Mitsubishi Heavy",verdict:"long",currentPrice:4820,prices:[2500,3200,4000,5200,6400,7800,9500],sens:{miu_jpy:.3,miu_inflows:.5,miu_admin:.6,miu_china:.4,miu_rates:.1,miu_defence:.9}},
      {ticker:"9984.T",name:"SoftBank Group",verdict:"long",currentPrice:4449,prices:[2200,2900,3700,4800,6000,7500,9500],sens:{miu_jpy:.4,miu_inflows:.8,miu_admin:.3,miu_china:-.3,miu_rates:.2,miu_defence:0}},
      {ticker:"6098.T",name:"Recruit Holdings",verdict:"long",currentPrice:10200,prices:[5500,7000,8600,11000,13500,16500,20000],sens:{miu_jpy:.5,miu_inflows:.6,miu_admin:.5,miu_china:-.1,miu_rates:.3,miu_defence:0}},
      {ticker:"6146.T",name:"DISCO Corp",verdict:"long",currentPrice:48000,prices:[25000,32000,40000,52000,65000,82000,105000],sens:{miu_jpy:.3,miu_inflows:.7,miu_admin:.3,miu_china:-.3,miu_rates:.2,miu_defence:0}},
      {ticker:"7203.T",name:"Toyota Motor",verdict:"short",currentPrice:3200,prices:[1500,2000,2600,3100,3800,4600,5600],sens:{miu_jpy:-.8,miu_inflows:.2,miu_admin:-.3,miu_china:-.4,miu_rates:-.2,miu_defence:0}},
      {ticker:"6752.T",name:"Panasonic",verdict:"short",currentPrice:1800,prices:[850,1100,1450,1750,2150,2600,3200],sens:{miu_jpy:-.5,miu_inflows:.1,miu_admin:-.2,miu_china:-.3,miu_rates:-.3,miu_defence:0}},
      {ticker:"7267.T",name:"Honda Motor",verdict:"short",currentPrice:1550,prices:[750,950,1250,1500,1850,2250,2800],sens:{miu_jpy:-.7,miu_inflows:.1,miu_admin:-.2,miu_china:-.5,miu_rates:-.2,miu_defence:0}},
      {ticker:"8058.T",name:"Mitsubishi Corp",verdict:"short",currentPrice:3787,prices:[1900,2400,3100,3700,4500,5400,6600],sens:{miu_jpy:-.5,miu_inflows:.3,miu_admin:-.1,miu_china:-.3,miu_rates:-.1,miu_defence:.2}},
    ]
  },
  {
    id:"ctc", name:"Cheung Tin-chi", fullName:"Cheung Tin-chi (å¼µå¤©å¿—)", teamId:"panasian",
    team:"Pan Asian Thematic", color:"#0ea5e9", icon:"ğŸ”¬", file:"ctc-v1.html",
    desc:"Semiconductor Dominance Â· TWD Risk Â· Domestic Wealth Â· Geopolitical Premium",
    driverMap:[
      {driverId:"ctc_semi",weight:30},{driverId:"ctc_twd",weight:20},{driverId:"ctc_wealth",weight:15},
      {driverId:"ctc_geopol",weight:15},{driverId:"ctc_ai",weight:10},{driverId:"ctc_rates",weight:10},
    ],
    drivers:[
      {id:"ctc_semi",label:"Semiconductor Dominance",signal:0.8},
      {id:"ctc_twd",label:"TWD Appreciation Risk",signal:-0.2},
      {id:"ctc_wealth",label:"Domestic Wealth Growth",signal:0.4},
      {id:"ctc_geopol",label:"Geopolitical Risk (Cross-Strait)",signal:-0.4},
      {id:"ctc_ai",label:"AI Capex Demand",signal:0.7},
      {id:"ctc_rates",label:"Global Rate Environment",signal:0.2},
    ],
    stocks:[
      {ticker:"2330.TW",name:"TSMC",verdict:"long",currentPrice:1915,prices:[1050,1300,1600,2050,2500,3050,3800],sens:{ctc_semi:.9,ctc_twd:-.2,ctc_wealth:.3,ctc_geopol:-.6,ctc_ai:.9,ctc_rates:.2}},
      {ticker:"2454.TW",name:"MediaTek",verdict:"long",currentPrice:1855,prices:[1000,1250,1550,2000,2450,3000,3700],sens:{ctc_semi:.8,ctc_twd:-.1,ctc_wealth:.2,ctc_geopol:-.3,ctc_ai:.8,ctc_rates:.2}},
      {ticker:"3711.TW",name:"ASE Technology",verdict:"long",currentPrice:293,prices:[155,195,245,315,385,470,580],sens:{ctc_semi:.8,ctc_twd:-.2,ctc_wealth:.1,ctc_geopol:-.3,ctc_ai:.7,ctc_rates:.1}},
      {ticker:"2308.TW",name:"Delta Electronics",verdict:"long",currentPrice:420,prices:[220,280,350,450,560,690,850],sens:{ctc_semi:.5,ctc_twd:-.1,ctc_wealth:.3,ctc_geopol:-.2,ctc_ai:.6,ctc_rates:.2}},
      {ticker:"6488.TW",name:"GlobalWafers",verdict:"long",currentPrice:550,prices:[280,360,460,590,730,900,1120],sens:{ctc_semi:.9,ctc_twd:-.1,ctc_wealth:.1,ctc_geopol:-.3,ctc_ai:.7,ctc_rates:.1}},
      {ticker:"3008.TW",name:"LARGAN Precision",verdict:"long",currentPrice:2600,prices:[1400,1800,2200,2800,3400,4200,5200],sens:{ctc_semi:.6,ctc_twd:-.2,ctc_wealth:.2,ctc_geopol:-.2,ctc_ai:.4,ctc_rates:.1}},
      {ticker:"2882.TW",name:"Cathay Financial",verdict:"short",currentPrice:78,prices:[38,50,63,76,92,112,138],sens:{ctc_semi:.1,ctc_twd:-.8,ctc_wealth:.3,ctc_geopol:-.2,ctc_ai:0,ctc_rates:-.7}},
      {ticker:"2881.TW",name:"Fubon Financial",verdict:"short",currentPrice:95,prices:[48,62,78,93,115,140,172],sens:{ctc_semi:.1,ctc_twd:-.8,ctc_wealth:.3,ctc_geopol:-.2,ctc_ai:0,ctc_rates:-.7}},
      {ticker:"2891.TW",name:"CTBC Financial",verdict:"short",currentPrice:42,prices:[20,26,34,41,50,62,76],sens:{ctc_semi:.1,ctc_twd:-.6,ctc_wealth:.2,ctc_geopol:-.2,ctc_ai:0,ctc_rates:-.5}},
      {ticker:"2303.TW",name:"United Micro",verdict:"short",currentPrice:62,prices:[30,40,52,61,74,90,110],sens:{ctc_semi:.3,ctc_twd:-.3,ctc_wealth:.1,ctc_geopol:-.3,ctc_ai:-.2,ctc_rates:.1}},
    ]
  },
  {
    id:"wzh", name:"Wan Zonghua", fullName:"Wan Zonghua (è¬å®—è¯)", teamId:"panasian",
    team:"Pan Asian Thematic", color:"#8b5cf6", icon:"âš”ï¸", file:"wzh-v1.html",
    desc:"HBM Supercycle Â· Value-Up Programme Â· Regional Flows Â· K-Defence",
    driverMap:[
      {driverId:"wzh_semi",weight:25},{driverId:"wzh_valueup",weight:20},{driverId:"wzh_flows",weight:15},
      {driverId:"wzh_china",weight:15},{driverId:"wzh_defence",weight:15},{driverId:"wzh_krw",weight:10},
    ],
    drivers:[
      {id:"wzh_semi",label:"Semiconductor / HBM Supercycle",signal:0.7},
      {id:"wzh_valueup",label:"Value-Up Programme",signal:0.5},
      {id:"wzh_flows",label:"Regional Capital Flows",signal:0.4},
      {id:"wzh_china",label:"China Exposure Risk",signal:-0.3},
      {id:"wzh_defence",label:"K-Defence Exports",signal:0.5},
      {id:"wzh_krw",label:"KRW Direction",signal:0.2},
    ],
    stocks:[
      {ticker:"005930.KS",name:"Samsung Electronics",verdict:"long",currentPrice:181200,prices:[95000,120000,152000,195000,240000,300000,380000],sens:{wzh_semi:.9,wzh_valueup:.6,wzh_flows:.5,wzh_china:-.3,wzh_defence:0,wzh_krw:.3}},
      {ticker:"000660.KS",name:"SK Hynix",verdict:"long",currentPrice:880000,prices:[450000,580000,730000,950000,1180000,1460000,1850000],sens:{wzh_semi:.9,wzh_valueup:.4,wzh_flows:.5,wzh_china:-.2,wzh_defence:0,wzh_krw:.3}},
      {ticker:"105560.KS",name:"KB Financial",verdict:"long",currentPrice:167900,prices:[88000,110000,140000,180000,225000,280000,350000],sens:{wzh_semi:.1,wzh_valueup:.9,wzh_flows:.6,wzh_china:-.1,wzh_defence:0,wzh_krw:.4}},
      {ticker:"035420.KS",name:"Naver",verdict:"long",currentPrice:252500,prices:[130000,165000,210000,270000,340000,420000,530000],sens:{wzh_semi:.3,wzh_valueup:.3,wzh_flows:.5,wzh_china:-.2,wzh_defence:0,wzh_krw:.2}},
      {ticker:"012450.KS",name:"Hanwha Aerospace",verdict:"long",currentPrice:1105000,prices:[580000,720000,920000,1200000,1500000,1880000,2400000],sens:{wzh_semi:0,wzh_valueup:.3,wzh_flows:.4,wzh_china:.3,wzh_defence:.9,wzh_krw:.2}},
      {ticker:"000270.KS",name:"Kia Corp",verdict:"long",currentPrice:164100,prices:[85000,108000,138000,175000,218000,270000,340000],sens:{wzh_semi:.1,wzh_valueup:.7,wzh_flows:.4,wzh_china:-.3,wzh_defence:0,wzh_krw:.3}},
      {ticker:"005380.KS",name:"Hyundai Motor",verdict:"short",currentPrice:499000,prices:[250000,320000,410000,490000,600000,740000,920000],sens:{wzh_semi:0,wzh_valueup:-.5,wzh_flows:.2,wzh_china:-.3,wzh_defence:0,wzh_krw:-.3}},
      {ticker:"010140.KS",name:"Samsung Heavy",verdict:"short",currentPrice:13500,prices:[5500,7500,10500,13000,16500,21000,27000],sens:{wzh_semi:0,wzh_valueup:-.3,wzh_flows:.1,wzh_china:-.4,wzh_defence:.2,wzh_krw:-.4}},
      {ticker:"009540.KS",name:"HD Hyundai Heavy",verdict:"short",currentPrice:185000,prices:[85000,115000,150000,180000,225000,280000,355000],sens:{wzh_semi:0,wzh_valueup:-.2,wzh_flows:.1,wzh_china:-.3,wzh_defence:.3,wzh_krw:-.3}},
      {ticker:"066570.KS",name:"LG Electronics",verdict:"short",currentPrice:92000,prices:[42000,56000,74000,90000,112000,140000,178000],sens:{wzh_semi:.2,wzh_valueup:-.4,wzh_flows:.1,wzh_china:-.4,wzh_defence:0,wzh_krw:-.2}},
    ]
  },
  {
    id:"frk", name:"Frank", fullName:"Frank", teamId:"panasian",
    team:"Pan Asian Thematic", color:"#14b8a6", icon:"ğŸ¦", file:"frk-v1.html",
    desc:"US-China Intermediary Â· Regional Capital Hub Â· ASEAN Growth Â· Financial Services",
    driverMap:[
      {driverId:"frk_uscn",weight:25},{driverId:"frk_hub",weight:20},{driverId:"frk_asean",weight:15},
      {driverId:"frk_finserv",weight:15},{driverId:"frk_rates",weight:15},{driverId:"frk_sgd",weight:10},
    ],
    drivers:[
      {id:"frk_uscn",label:"US-China Intermediary Role",signal:0.6},
      {id:"frk_hub",label:"Regional Capital Hub",signal:0.7},
      {id:"frk_asean",label:"ASEAN Growth Tailwind",signal:0.5},
      {id:"frk_finserv",label:"Financial Services Demand",signal:0.5},
      {id:"frk_rates",label:"Rate Environment",signal:0.3},
      {id:"frk_sgd",label:"SGD Strength",signal:0.3},
    ],
    stocks:[
      {ticker:"D05.SI",name:"DBS Group",verdict:"long",currentPrice:56.89,prices:[32,40,48,61,74,90,110],sens:{frk_uscn:.6,frk_hub:.8,frk_asean:.5,frk_finserv:.9,frk_rates:.6,frk_sgd:.4}},
      {ticker:"O39.SI",name:"OCBC Bank",verdict:"long",currentPrice:21.11,prices:[12,15,18,23,28,34,42],sens:{frk_uscn:.5,frk_hub:.7,frk_asean:.5,frk_finserv:.8,frk_rates:.6,frk_sgd:.4}},
      {ticker:"U11.SI",name:"UOB",verdict:"long",currentPrice:38.39,prices:[21,26,33,41,50,62,76],sens:{frk_uscn:.5,frk_hub:.7,frk_asean:.6,frk_finserv:.8,frk_rates:.5,frk_sgd:.3}},
      {ticker:"A17U.SI",name:"CapitaLand Ascendas REIT",verdict:"long",currentPrice:2.71,prices:[1.50,1.90,2.35,2.90,3.50,4.20,5.10],sens:{frk_uscn:.4,frk_hub:.7,frk_asean:.6,frk_finserv:.3,frk_rates:-.4,frk_sgd:.2}},
      {ticker:"BN4.SI",name:"Keppel Ltd",verdict:"long",currentPrice:7.50,prices:[4.00,5.00,6.30,8.10,10.00,12.30,15.20],sens:{frk_uscn:.5,frk_hub:.6,frk_asean:.7,frk_finserv:.3,frk_rates:-.2,frk_sgd:.2}},
      {ticker:"SE",name:"Sea Ltd",verdict:"long",currentPrice:145,prices:[75,95,120,155,195,245,310],sens:{frk_uscn:.3,frk_hub:.4,frk_asean:.9,frk_finserv:.4,frk_rates:.2,frk_sgd:.1}},
      {ticker:"Z74.SI",name:"Singtel",verdict:"short",currentPrice:4.84,prices:[2.50,3.20,4.00,4.80,5.80,7.00,8.50],sens:{frk_uscn:-.1,frk_hub:.2,frk_asean:.3,frk_finserv:.1,frk_rates:-.3,frk_sgd:-.2}},
      {ticker:"C6L.SI",name:"Singapore Airlines",verdict:"short",currentPrice:7.00,prices:[3.50,4.50,5.80,6.90,8.40,10.20,12.50],sens:{frk_uscn:-.2,frk_hub:.3,frk_asean:.4,frk_finserv:0,frk_rates:-.2,frk_sgd:-.4}},
      {ticker:"F34.SI",name:"Wilmar International",verdict:"short",currentPrice:3.20,prices:[1.60,2.10,2.70,3.15,3.85,4.70,5.80],sens:{frk_uscn:-.3,frk_hub:.1,frk_asean:.3,frk_finserv:0,frk_rates:-.1,frk_sgd:-.3}},
      {ticker:"S68.SI",name:"SGX Ltd",verdict:"short",currentPrice:13.50,prices:[7.00,9.00,11.50,13.30,16.00,19.50,24.00],sens:{frk_uscn:.2,frk_hub:.4,frk_asean:.2,frk_finserv:.5,frk_rates:-.2,frk_sgd:.1}},
    ]
  },
];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• COMPUTE OPERATOR STATS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function computeOpStats(op, globalDrivers) {
  const results = op.stocks.map(s => {
    const eng = runEngine(s, op.driverMap, globalDrivers);
    return { ...s, eng };
  });
  const longs = results.filter(s => s.verdict === 'long');
  const shorts = results.filter(s => s.verdict === 'short');
  const avgLongRR = longs.length ? longs.reduce((a,s) => a + (s.eng?.rr||0), 0) / longs.length : 0;
  const avgShortRR = shorts.length ? shorts.reduce((a,s) => a + (s.eng?.rr||0), 0) / shorts.length : 0;
  const avgSkew = results.length ? results.reduce((a,s) => a + (s.eng?.skew||0), 0) / results.length : 0;
  const bullPct = globalDrivers.filter(d => op.drivers.some(od => od.id === d.id) && d.signal > 0.3).length;
  const totalD = op.drivers.length;
  let regime = 'NEUTRAL';
  if (avgLongRR > 10) regime = 'BULLISH';
  if (avgLongRR > 20) regime = 'STRONG BULL';
  if (avgLongRR < -5) regime = 'BEARISH';
  if (avgLongRR < -15) regime = 'STRONG BEAR';
  return { results, longs: longs.length, shorts: shorts.length, avgLongRR, avgShortRR, avgSkew, bullPct, totalD, regime };
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MICRO COMPONENTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function Badge({children,color,small,style:sx}){return<span style={{display:'inline-flex',alignItems:'center',padding:small?'1px 6px':'2px 8px',borderRadius:3,fontSize:small?9:10,fontWeight:700,fontFamily:'var(--mono)',letterSpacing:'.04em',background:`${color}15`,color,border:`1px solid ${color}35`,...sx}}>{children}</span>}
function Btn({children,onClick,active,color,style:sx,...p}){const c=color||'var(--fg3)';return<button onClick={onClick} style={{padding:'6px 12px',borderRadius:4,cursor:'pointer',fontSize:11,fontFamily:'var(--mono)',fontWeight:600,transition:'all .15s',border:`1px solid ${active?c+'60':'var(--border)'}`,background:active?c+'12':'transparent',color:active?c:'var(--fg4)',...sx}} {...p}>{children}</button>}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function Header({view, setView}) {
  const navItems = [
    {id:'overview', label:'Overview', icon:'â—‰'},
    {id:'macro', label:'Macro Dashboard', icon:'âš¡'},
    {id:'operators', label:'Operators', icon:'â—†'},
    {id:'data', label:'Data', icon:'â¬†'},
    {id:'export', label:'Export', icon:'â†“'},
  ];
  return <div style={{background:'var(--bg1)',borderBottom:'1px solid var(--border2)',padding:'0 28px',display:'flex',alignItems:'center',gap:0,height:52,flexShrink:0}}>
    <div style={{display:'flex',alignItems:'center',gap:10,marginRight:40}}>
      <div style={{width:8,height:8,borderRadius:'50%',background:'var(--g)',boxShadow:'0 0 8px var(--g)',animation:'pulse 2s infinite'}}/>
      <span style={{fontSize:20,fontFamily:'var(--mono)',fontWeight:700,color:'var(--fg)',letterSpacing:'-.02em'}}>XA</span>
      <span style={{fontSize:10,color:'var(--fg4)',fontFamily:'var(--mono)',letterSpacing:'.05em'}}>powered by Upside</span>
    </div>
    <div style={{display:'flex',gap:2}}>
      {navItems.map(n => <button key={n.id} onClick={() => setView(n.id)} style={{
        padding:'14px 16px',fontSize:11,fontFamily:'var(--mono)',fontWeight:600,cursor:'pointer',
        border:'none',background:'transparent',color:view===n.id?'var(--fg)':'var(--fg4)',
        borderBottom:view===n.id?'2px solid var(--g)':'2px solid transparent',
        transition:'all .15s'
      }}>{n.icon} {n.label}</button>)}
    </div>
  </div>;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• OVERVIEW â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function OverviewView({operators, globalDrivers}) {
  const allStats = operators.map(op => ({...op, stats: computeOpStats(op, globalDrivers)}));
  const totalNames = allStats.reduce((a,o) => a + o.stocks.length, 0);
  const totalLongs = allStats.reduce((a,o) => a + o.stats.longs, 0);
  const totalShorts = allStats.reduce((a,o) => a + o.stats.shorts, 0);
  const totalDrivers = allStats.reduce((a,o) => a + o.drivers.length, 0);
  const bullOps = allStats.filter(o => o.stats.avgLongRR > 8).length;

  return <div style={{padding:32,maxWidth:1200,margin:'0 auto',animation:'fadeIn .3s ease'}}>
    <div style={{marginBottom:32}}>
      <h1 style={{fontSize:32,fontFamily:'var(--serif)',color:'var(--fg)',fontWeight:400,marginBottom:6}}>Command Centre</h1>
      <p style={{fontSize:13,color:'var(--fg3)'}}>GRS Â· Pan Asian Thematic â€” {operators.length} operators across {new Set(operators.map(o=>o.team)).size} sectors</p>
    </div>

    {/* Stats Row */}
    <div style={{display:'grid',gridTemplateColumns:'repeat(6,1fr)',gap:12,marginBottom:32}}>
      {[
        ['Operators', operators.length, 'var(--fg)'],
        ['Total Names', totalNames, 'var(--b)'],
        ['Longs', totalLongs, 'var(--g)'],
        ['Shorts', totalShorts, 'var(--r)'],
        ['Macro Drivers', totalDrivers, 'var(--y)'],
        ['Bull Operators', bullOps+'/'+operators.length, 'var(--g2)'],
      ].map(([l,v,c]) => <div key={l} style={{padding:'16px 18px',background:'var(--bg2)',border:'1px solid var(--border)',borderRadius:6}}>
        <div style={{fontSize:9,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase',letterSpacing:'.1em',marginBottom:6}}>{l}</div>
        <div style={{fontSize:22,fontFamily:'var(--mono)',fontWeight:700,color:c}}>{v}</div>
      </div>)}
    </div>

    {/* Operator Cards */}
    <div style={{fontSize:9,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase',letterSpacing:'.12em',marginBottom:12}}>Operator Status</div>
    <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(340px,1fr))',gap:14}}>
      {allStats.map(op => {
        const s = op.stats;
        const regimeColor = s.regime.includes('BULL') ? 'var(--g)' : s.regime.includes('BEAR') ? 'var(--r)' : 'var(--fg3)';
        return <div key={op.id} style={{background:'var(--bg2)',border:`1px solid ${op.color}20`,borderRadius:8,overflow:'hidden'}}>
          <div style={{padding:'16px 20px',borderBottom:'1px solid var(--border)'}}>
            <div style={{display:'flex',alignItems:'center',justifyContent:'space-between',marginBottom:8}}>
              <div style={{display:'flex',alignItems:'center',gap:10}}>
                <span style={{fontSize:20}}>{op.icon}</span>
                <div>
                  <span style={{fontSize:16,fontFamily:'var(--mono)',fontWeight:700,color:op.color}}>{op.name}</span>
                  <span style={{fontSize:11,color:'var(--fg4)',marginLeft:8}}>{op.team}</span>
                </div>
              </div>
              <Badge color={regimeColor} small>{s.regime}</Badge>
            </div>
            <div style={{fontSize:11,color:'var(--fg3)',marginBottom:8}}>{op.desc}</div>
          </div>
          <div style={{padding:'12px 20px',display:'grid',gridTemplateColumns:'repeat(4,1fr)',gap:8}}>
            <div><div style={{fontSize:8,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase'}}>Names</div><div style={{fontSize:14,fontFamily:'var(--mono)',fontWeight:600,color:'var(--fg)'}}>{op.stocks.length}</div></div>
            <div><div style={{fontSize:8,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase'}}>L / S</div><div style={{fontSize:14,fontFamily:'var(--mono)',fontWeight:600}}><span style={{color:'var(--g)'}}>{s.longs}</span><span style={{color:'var(--fg4)'}}> / </span><span style={{color:'var(--r)'}}>{s.shorts}</span></div></div>
            <div><div style={{fontSize:8,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase'}}>Avg R/R</div><div style={{fontSize:14,fontFamily:'var(--mono)',fontWeight:600,color:s.avgLongRR>0?'var(--g)':'var(--r)'}}>{fmt(s.avgLongRR,'pct')}</div></div>
            <div><div style={{fontSize:8,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase'}}>Avg Skew</div><div style={{fontSize:14,fontFamily:'var(--mono)',fontWeight:600,color:s.avgSkew>1?'var(--g)':'var(--fg3)'}}>{fmt(s.avgSkew,'ratio')}</div></div>
          </div>
          <div style={{padding:'8px 20px 14px'}}>
            <a href={op.file} target="_blank" rel="noopener" style={{display:'block',textAlign:'center',padding:'8px',fontSize:11,fontFamily:'var(--mono)',fontWeight:700,borderRadius:4,cursor:'pointer',border:`1px solid ${op.color}40`,background:`${op.color}08`,color:op.color,textDecoration:'none',transition:'all .15s'}}>
              Open {op.name} Engine â†’
            </a>
          </div>
        </div>;
      })}
    </div>
  </div>;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MACRO DASHBOARD (Grouped by Operator) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function MacroView({operators, globalDrivers, setGlobalDrivers}) {
  const [collapsed, setCollapsed] = useState({});
  const toggle = id => setCollapsed(p => ({...p, [id]: !p[id]}));

  const updateSignal = (driverId, val) => {
    setGlobalDrivers(p => p.map(d => d.id === driverId ? {...d, signal: val} : d));
  };

  const bullCount = globalDrivers.filter(d => d.signal > 0.3).length;
  const bearCount = globalDrivers.filter(d => d.signal < -0.3).length;
  const neutralCount = globalDrivers.length - bullCount - bearCount;

  return <div style={{padding:32,maxWidth:1000,margin:'0 auto',animation:'fadeIn .3s ease'}}>
    <div style={{marginBottom:28}}>
      <h1 style={{fontSize:28,fontFamily:'var(--serif)',color:'var(--y)',fontWeight:400,marginBottom:6}}>Macro Dashboard</h1>
      <p style={{fontSize:12,color:'var(--fg4)'}}>Adjust global signals. Changes flow through to all operator engines in real time.</p>
    </div>

    <div style={{display:'flex',gap:12,marginBottom:24}}>
      <Badge color="var(--g)">{bullCount} Bull</Badge>
      <Badge color="var(--fg3)">{neutralCount} Neutral</Badge>
      <Badge color="var(--r)">{bearCount} Bear</Badge>
      <span style={{fontSize:10,color:'var(--fg4)',fontFamily:'var(--mono)',marginLeft:'auto'}}>{globalDrivers.length} drivers across {operators.length} operators</span>
    </div>

    {operators.map(op => {
      const isCollapsed = collapsed[op.id];
      const opDrivers = globalDrivers.filter(gd => op.drivers.some(od => od.id === gd.id));
      const avgSig = opDrivers.length ? opDrivers.reduce((a,d) => a + d.signal, 0) / opDrivers.length : 0;
      const avgColor = avgSig > 0.2 ? 'var(--g)' : avgSig < -0.2 ? 'var(--r)' : 'var(--fg3)';

      return <div key={op.id} style={{marginBottom:12,background:'var(--bg2)',border:`1px solid ${op.color}15`,borderRadius:8,overflow:'hidden'}}>
        <div onClick={() => toggle(op.id)} style={{padding:'14px 20px',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'space-between',borderBottom:isCollapsed?'none':'1px solid var(--border)'}}>
          <div style={{display:'flex',alignItems:'center',gap:10}}>
            <span style={{fontSize:16}}>{op.icon}</span>
            <span style={{fontSize:14,fontFamily:'var(--mono)',fontWeight:700,color:op.color}}>{op.name}</span>
            <span style={{fontSize:11,color:'var(--fg4)'}}>{op.team}</span>
          </div>
          <div style={{display:'flex',alignItems:'center',gap:12}}>
            <span style={{fontSize:11,fontFamily:'var(--mono)',fontWeight:600,color:avgColor}}>avg: {avgSig>0?'+':''}{avgSig.toFixed(2)}</span>
            <Badge color={op.color} small>{opDrivers.length} drivers</Badge>
            <span style={{fontSize:14,color:'var(--fg4)',transition:'transform .2s',transform:isCollapsed?'rotate(-90deg)':'rotate(0)'}}>{isCollapsed ? 'â–¸' : 'â–¾'}</span>
          </div>
        </div>
        {!isCollapsed && <div style={{padding:'8px 20px 16px'}}>
          {opDrivers.map(d => {
            const sc = d.signal > 0.3 ? 'var(--g)' : d.signal < -0.3 ? 'var(--r)' : 'var(--fg3)';
            const sl = d.signal > 0.5 ? 'STRONG BULL' : d.signal > 0.2 ? 'BULLISH' : d.signal > -0.2 ? 'NEUTRAL' : d.signal > -0.5 ? 'BEARISH' : 'STRONG BEAR';
            return <div key={d.id} style={{padding:'10px 0',borderBottom:'1px solid var(--border)',display:'grid',gridTemplateColumns:'200px 1fr 100px',gap:16,alignItems:'center'}}>
              <div>
                <div style={{fontSize:12,fontFamily:'var(--mono)',fontWeight:600,color:'var(--fg)'}}>{d.label}</div>
              </div>
              <div style={{display:'flex',alignItems:'center',gap:8}}>
                <span style={{fontSize:9,fontFamily:'var(--mono)',color:'var(--r)',width:16,textAlign:'right'}}>-1</span>
                <input type="range" min="-100" max="100" value={Math.round(d.signal*100)} onChange={e => updateSignal(d.id, parseInt(e.target.value)/100)} style={{flex:1,accentColor:sc}}/>
                <span style={{fontSize:9,fontFamily:'var(--mono)',color:'var(--g)',width:16}}>+1</span>
              </div>
              <div style={{textAlign:'right'}}>
                <span style={{fontSize:12,fontFamily:'var(--mono)',fontWeight:700,color:sc}}>{d.signal>0?'+':''}{d.signal.toFixed(2)}</span>
                <div style={{fontSize:8,fontFamily:'var(--mono)',color:sc,marginTop:1}}>{sl}</div>
              </div>
            </div>;
          })}
        </div>}
      </div>;
    })}
  </div>;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• OPERATORS VIEW â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function OperatorsView({operators, globalDrivers}) {
  const allStats = operators.map(op => ({...op, stats: computeOpStats(op, globalDrivers)}));

  return <div style={{padding:32,maxWidth:1200,margin:'0 auto',animation:'fadeIn .3s ease'}}>
    <div style={{marginBottom:28}}>
      <h1 style={{fontSize:28,fontFamily:'var(--serif)',color:'var(--p)',fontWeight:400,marginBottom:6}}>GRS Â· Pan Asian Operators</h1>
      <p style={{fontSize:12,color:'var(--fg4)'}}>Click any operator to open its full interactive engine with scenario sliders, stock cards, and positioning data.</p>
    </div>

    {allStats.map(op => {
      const s = op.stats;
      const topLongs = s.results.filter(r => r.verdict==='long').sort((a,b) => (b.eng?.rr||0)-(a.eng?.rr||0)).slice(0,3);
      const topShorts = s.results.filter(r => r.verdict==='short').sort((a,b) => (a.eng?.rr||0)-(b.eng?.rr||0)).slice(0,3);

      return <div key={op.id} style={{marginBottom:20,background:'var(--bg2)',border:`1px solid ${op.color}15`,borderRadius:8,overflow:'hidden'}}>
        <div style={{padding:'18px 24px',borderBottom:'1px solid var(--border)',display:'flex',alignItems:'center',justifyContent:'space-between'}}>
          <div style={{display:'flex',alignItems:'center',gap:12}}>
            <span style={{fontSize:24}}>{op.icon}</span>
            <div>
              <div style={{display:'flex',alignItems:'center',gap:8}}>
                <span style={{fontSize:18,fontFamily:'var(--mono)',fontWeight:700,color:op.color}}>{op.name}</span>
                <span style={{fontSize:12,color:'var(--fg3)'}}>{op.team}</span>
              </div>
              <div style={{fontSize:11,color:'var(--fg4)',marginTop:2}}>{op.desc}</div>
            </div>
          </div>
          <a href={op.file} target="_blank" rel="noopener" style={{padding:'8px 16px',fontSize:11,fontFamily:'var(--mono)',fontWeight:700,borderRadius:4,cursor:'pointer',border:`1px solid ${op.color}40`,background:`${op.color}08`,color:op.color,textDecoration:'none'}}>
            Open Engine â†’
          </a>
        </div>

        <div style={{padding:'14px 24px',display:'grid',gridTemplateColumns:'repeat(6,1fr)',gap:12}}>
          <div><div style={{fontSize:8,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase'}}>Names</div><div style={{fontSize:16,fontFamily:'var(--mono)',fontWeight:600,color:'var(--fg)'}}>{op.stocks.length}</div></div>
          <div><div style={{fontSize:8,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase'}}>Long R/R</div><div style={{fontSize:16,fontFamily:'var(--mono)',fontWeight:600,color:'var(--g)'}}>{fmt(s.avgLongRR,'pct')}</div></div>
          <div><div style={{fontSize:8,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase'}}>Short R/R</div><div style={{fontSize:16,fontFamily:'var(--mono)',fontWeight:600,color:'var(--r)'}}>{fmt(s.avgShortRR,'pct')}</div></div>
          <div><div style={{fontSize:8,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase'}}>Avg Skew</div><div style={{fontSize:16,fontFamily:'var(--mono)',fontWeight:600,color:s.avgSkew>1?'var(--g)':'var(--fg3)'}}>{fmt(s.avgSkew,'ratio')}</div></div>
          <div><div style={{fontSize:8,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase'}}>Drivers</div><div style={{fontSize:16,fontFamily:'var(--mono)',fontWeight:600,color:'var(--y)'}}>{op.drivers.length}</div></div>
          <div><div style={{fontSize:8,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase'}}>Regime</div><div style={{fontSize:12,fontFamily:'var(--mono)',fontWeight:600,color:s.regime.includes('BULL')?'var(--g)':s.regime.includes('BEAR')?'var(--r)':'var(--fg3)'}}>{s.regime}</div></div>
        </div>

        <div style={{padding:'0 24px 16px',display:'grid',gridTemplateColumns:'1fr 1fr',gap:16}}>
          <div>
            <div style={{fontSize:8,color:'var(--g)',fontFamily:'var(--mono)',textTransform:'uppercase',letterSpacing:'.1em',marginBottom:6}}>Top Longs by R/R</div>
            {topLongs.map(s => <div key={s.ticker} style={{display:'flex',alignItems:'center',justifyContent:'space-between',padding:'4px 0',fontSize:11,fontFamily:'var(--mono)'}}>
              <span style={{color:'var(--fg)',fontWeight:600}}>{s.ticker}</span>
              <span style={{color:'var(--fg3)'}}>{s.name}</span>
              <span style={{color:'var(--g)',fontWeight:700}}>{fmt(s.eng?.rr,'pct')}</span>
            </div>)}
          </div>
          <div>
            <div style={{fontSize:8,color:'var(--r)',fontFamily:'var(--mono)',textTransform:'uppercase',letterSpacing:'.1em',marginBottom:6}}>Top Shorts by R/R</div>
            {topShorts.map(s => <div key={s.ticker} style={{display:'flex',alignItems:'center',justifyContent:'space-between',padding:'4px 0',fontSize:11,fontFamily:'var(--mono)'}}>
              <span style={{color:'var(--fg)',fontWeight:600}}>{s.ticker}</span>
              <span style={{color:'var(--fg3)'}}>{s.name}</span>
              <span style={{color:'var(--r)',fontWeight:700}}>{fmt(s.eng?.rr,'pct')}</span>
            </div>)}
          </div>
        </div>
      </div>;
    })}
  </div>;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DATA UPLOAD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* Operator screening rules: geography + GICS sector matching */
const SCREEN_RULES = {
  tig: { sectors: ['Transportation','Hotels, Restaurants & Leisure','Airlines','Air Freight & Logistics','Leisure Products','Passenger Airlines','Hotels, Resorts & Cruise Lines','Casinos & Gaming','Leisure Facilities','Airport Services'], geo: null },
  rone: { sectors: ['Aerospace & Defense'], geo: ['GB','FR','DE','IT','SE','NO','NL','ES','FI','DK','PL','RO','GR','CZ','BE','IL'] },
  tanto: { sectors: ['Energy','Oil, Gas & Consumable Fuels','Energy Equipment & Services','Oil & Gas Exploration & Production','Oil & Gas Refining & Marketing','Integrated Oil & Gas'], geo: null },
  jack: { sectors: ['Semiconductors & Semiconductor Equipment','Technology Hardware, Storage & Peripherals','Electronic Equipment, Instruments & Components','Communications Equipment','IT Services','Systems Software','Application Software'], geo: null, keywords: ['semiconductor','chip','AI','neural','GPU','ASML','foundry','wafer','networking','cyber'] },
  boon: { sectors: ['Transaction & Payment Processing Services','Financial Exchanges & Data','Consumer Finance','Diversified Financial Services'], geo: null, keywords: ['payment','fintech','digital bank','BNPL','crypto','commerce platform'] },
  oz: { sectors: ['Pharmaceuticals','Biotechnology','Life Sciences Tools & Services','Health Care Equipment & Supplies','Health Care Technology','Managed Health Care','Health Care Distributors','Health Care Services','Health Care Facilities'], geo: null },
  ipm: { sectors: null, geo: ['CN','HK'] },
  miu: { sectors: null, geo: ['JP'] },
  ctc: { sectors: null, geo: ['TW'] },
  wzh: { sectors: null, geo: ['KR'] },
  frk: { sectors: null, geo: ['SG'] },
};

function matchOperators(row) {
  const matches = [];
  const country = (row.country || '').toUpperCase().trim();
  const sector = (row.gics_sector || '').trim();
  const industry = (row.gics_industry || '').trim();
  const name = (row.name || '').toLowerCase();

  Object.entries(SCREEN_RULES).forEach(([opId, rule]) => {
    let geoMatch = !rule.geo || rule.geo.includes(country);
    let sectorMatch = !rule.sectors || rule.sectors.some(s =>
      sector.toLowerCase().includes(s.toLowerCase()) ||
      industry.toLowerCase().includes(s.toLowerCase())
    );
    let keywordMatch = rule.keywords ? rule.keywords.some(k => name.includes(k.toLowerCase()) || industry.toLowerCase().includes(k.toLowerCase())) : false;

    if (rule.geo && rule.sectors) {
      if (geoMatch && (sectorMatch || keywordMatch)) matches.push(opId);
    } else if (rule.geo) {
      if (geoMatch) matches.push(opId);
    } else if (rule.sectors) {
      if (sectorMatch || keywordMatch) matches.push(opId);
    }
  });
  return matches;
}

/* Normalise ticker for matching â€” collapses BBG exchange codes to composite */
const EXCH_MAP = {
  'UW':'US','UN':'US','UP':'US','UA':'US','UQ':'US','UR':'US','UV':'US',
  'LS':'LN','LI':'LN','CT':'CN',
  'GY':'GR','GF':'GR',
  'JT':'JP',
  'KP':'KS',
  'SI':'SP',
  'AT':'AU',
  'SE':'SW','VX':'SW',
  'MI':'IM',
  'PA':'FP','EN':'FP',
  'MC':'SM','SQ':'SM',
  'OL':'NO',
  'AS':'NA',
  'BB':'ID',
  'IS':'TI',
  'CO':'DC',
};
function normTicker(t) {
  if (!t) return '';
  let s = t.replace(/\s+(Equity|Index)$/i,'').replace(/\//g,'').replace(/\s+/g,' ').trim().toUpperCase();
  const parts = s.split(' ');
  if (parts.length === 2 && EXCH_MAP[parts[1]]) {
    parts[1] = EXCH_MAP[parts[1]];
    s = parts.join(' ');
  }
  return s;
}

/* Reverse map: BBG exchange code â†’ XA ticker suffix */
const BBG_TO_XA = {
  'US':['',''], 'UW':['',''], 'UN':['',''], 'UP':['',''], 'UA':['',''], 'UQ':['',''],
  'CN':['','.TO'], 'CT':['','.TO'],
  'LN':['.L'], 'LS':['.L'], 'LI':['.L'],
  'GR':['.DE'], 'GY':['.DE'], 'GF':['.DE'],
  'FP':['.PA'], 'PA':['.PA'], 'EN':['.PA'],
  'IM':['.MI'], 'MI':['.MI'],
  'SM':['.MC'], 'MC':['.MC'], 'SQ':['.MC'],
  'NA':['.AS'], 'AS':['.AS'],
  'NO':['.OL'], 'OL':['.OL'],
  'SW':['.SW'], 'SE':['.SW'], 'VX':['.SW'],
  'TI':['.IS'], 'IS':['.IS'],
  'DC':['.CO'], 'CO':['.CO'],
  'ID':['.JK'],
  'JP':['.T'], 'JT':['.T'],
  'HK':['.HK'],
  'TT':['.TW'],
  'KS':['.KS'], 'KP':['.KS'],
  'SP':['.SI'],
  'AU':['.AX'], 'AT':['.AX'], 'AX':['.AX'],
  'CH':['.SZ','.SH'],
  'BB':['.BK'],
};

/* Convert BBG ticker to all possible XA ticker formats */
function bbgToXA(bbg) {
  const clean = bbg.replace(/\s+(Equity|Index)$/i,'').replace(/\//g,'').trim();
  const parts = clean.split(/\s+/);
  if (parts.length !== 2) return [clean, clean.toUpperCase()]; /* No exchange code, try as-is */
  const [sym, exch] = parts;
  const suffixes = BBG_TO_XA[exch.toUpperCase()] || [''];
  const results = [];
  suffixes.forEach(sfx => {
    results.push(sym + sfx);
    if (exch.toUpperCase() === 'HK') {
      /* HK tickers: try with and without leading zeros (0700.HK vs 700.HK) */
      results.push(sym.padStart(4,'0') + sfx);
      results.push(sym.replace(/^0+/,'') + sfx);
    }
  });
  return results;
}

/* Build a lookup map from BBG tickers to XA operator tickers */
/* Includes explicit aliases for Singapore and other non-standard mappings */
const BBG_ALIASES = {
  'DBS SP': 'D05.SI', 'OCBC SP': 'O39.SI', 'UOB SP': 'U11.SI',
  'CLAR SP': 'A17U.SI', 'KEP SP': 'BN4.SI', 'ST SP': 'Z74.SI',
  'SIA SP': 'C6L.SI', 'WIL SP': 'F34.SI', 'SGX SP': 'S68.SI',
  'SE US': 'SE', 'BA LN': 'BA.L', 'BP LN': 'BP.L', 'RR LN': 'RR.L',
  'FLIR US': 'FLIR', 'RYA ID': 'RYA.L',
};

function buildTickerMap(operators) {
  const map = {};
  operators.forEach(op => {
    op.stocks.forEach(s => {
      const t = s.ticker;
      const variants = [
        t.toUpperCase(),
        t.replace('.HK','').replace(/^0+/,'') + ' HK',
        '0' + t.replace('.HK','').replace(/^0+/,'') + ' HK',  /* with leading zero */
        t.replace('.T','') + ' JP',
        t.replace('.TW','') + ' TT',
        t.replace('.KS','') + ' KS',
        t.replace('.SI','') + ' SP',
        t.replace('.SZ','') + ' CH',
        t.replace('.SH','') + ' CH',
        t.replace('.L','') + ' LN',
        t.replace('.DE','') + ' GR',
        t.replace('.PA','') + ' FP',
        t.replace('.MI','') + ' IM',
        t.replace('.MC','') + ' SM',
        t.replace('.OL','') + ' NO',
        t.replace('.AS','') + ' NA',
        t.replace('.AX','') + ' AU',
        t.replace('.SW','') + ' SW',
        t.replace('.IS','') + ' TI',
        t + ' US',
      ];
      variants.forEach(v => {
        const key = normTicker(v);
        if (key) map[key] = { opId: op.id, ticker: t };
      });
    });
  });
  /* Add explicit BBG aliases */
  Object.entries(BBG_ALIASES).forEach(([bbg, xaTicker]) => {
    const op = operators.find(o => o.stocks.some(s => s.ticker === xaTicker));
    if (op) map[bbg.toUpperCase()] = { opId: op.id, ticker: xaTicker };
  });
  return map;
}

function DataView({operators, globalDrivers, snapData, setSnapData}) {
  const [dragOver, setDragOver] = useState(false);
  const [parsing, setParsing] = useState(false);
  const [error, setError] = useState(null);
  const [filter, setFilter] = useState('all');
  const [sortCol, setSortCol] = useState('mkt_cap_m');
  const [sortDir, setSortDir] = useState('desc');
  const [searchQ, setSearchQ] = useState('');
  const [opFilter, setOpFilter] = useState('all');
  const fileRef = useRef();

  const parseFile = (file) => {
    setParsing(true);
    setError(null);
    const reader = new FileReader();
    reader.onload = (e) => {
      try {
        const wb = XLSX.read(e.target.result, {type:'array'});
        /* Try Upload, Universe, or first sheet */
        const sheetName = ['Upload','Universe','MSCI World','MSCI China','Sheet1'].find(n => wb.SheetNames.includes(n)) || wb.SheetNames[0];
        const ws = wb.Sheets[sheetName];

        /* Find header row: scan for row containing any known ticker column name */
        const allRows = XLSX.utils.sheet_to_json(ws, {header:1, defval:''});
        let headerIdx = -1;
        const HEADER_MARKERS = ['bbg_ticker','ticker','BBG_TICKER','Ticker','xa_ticker','BBG Ticker','XA Ticker'];
        for (let i = 0; i < Math.min(allRows.length, 20); i++) {
          const row = allRows[i];
          if (Array.isArray(row) && row.some(c => HEADER_MARKERS.includes(String(c).trim()))) {
            headerIdx = i; break;
          }
        }

        /* Column name normaliser: maps display headers to snake_case keys */
        const COL_NORM = {
          'bbg ticker':'bbg_ticker','bbg_ticker':'bbg_ticker','ticker':'bbg_ticker','xa ticker':'bbg_ticker','xa_ticker':'bbg_ticker',
          'name':'name','security_name':'name',
          'country':'country','country_iso':'country',
          'gics sector':'gics_sector','gics_sector_name':'gics_sector','gics sector name':'gics_sector',
          'gics industry':'gics_industry','gics_industry_group_name':'gics_industry','gics industry group name':'gics_industry','gics industry group':'gics_industry',
          'ccy':'ccy','crncy':'ccy','currency':'ccy',
          'mkt cap ($m)':'mkt_cap_m','mkt cap (m)':'mkt_cap_m','mkt_cap_m':'mkt_cap_m','cur_mkt_cap':'mkt_cap_m','mkt cap':'mkt_cap_m','market cap':'mkt_cap_m',
          'price':'price','price (fri cob)':'price','px_last':'price','px last':'price','last price':'price',
          'fwd p/e':'fwd_pe','fwd pe':'fwd_pe','fwd_pe':'fwd_pe','best_pe_ratio':'fwd_pe','best pe ratio':'fwd_pe',
          'trail p/e':'trail_pe','trail pe':'trail_pe','trail_pe':'trail_pe','pe_ratio':'trail_pe','pe ratio':'trail_pe',
          'fwd ev/ebitda':'fwd_ev_ebitda','fwd_ev_ebitda':'fwd_ev_ebitda','best_ev_to_ebitda':'fwd_ev_ebitda','fwd ev/eb':'fwd_ev_ebitda','ev/ebitda':'fwd_ev_ebitda',
          'p/b':'pb','pb':'pb','px_to_book_ratio':'pb','price to book':'pb',
          'ev/sales':'ev_sales','ev_sales':'ev_sales','best_ev_to_best_sales':'ev_sales',
          'roe %':'roe_pct','roe_pct':'roe_pct','return_com_eqy':'roe_pct','roe':'roe_pct',
          'op margin %':'op_margin_pct','op_margin_pct':'op_margin_pct','oper_margin':'op_margin_pct','operating margin':'op_margin_pct',
          'net margin %':'net_margin_pct','net_margin_pct':'net_margin_pct','prof_margin':'net_margin_pct','net margin':'net_margin_pct',
          'fcf/share':'fcf_per_sh','fcf_per_sh':'fcf_per_sh','cf_free_cash_flow_per_sh':'fcf_per_sh','fcf per share':'fcf_per_sh',
          '52w chg %':'chg_52w_pct','chg_52w_pct':'chg_52w_pct','chg_pct_52wk':'chg_52w_pct','52 week change':'chg_52w_pct',
          'eps rev 3m %':'eps_rev_3m_pct','eps_rev_3m_pct':'eps_rev_3m_pct','best_eps_3mo_pct_chg':'eps_rev_3m_pct','eps revision':'eps_rev_3m_pct',
          'beta':'beta','eqy_beta':'beta',
          'nd/ebitda':'nd_ebitda','nd_ebitda':'nd_ebitda','tot_debt_to_ebitda':'nd_ebitda','net debt/ebitda':'nd_ebitda',
          'div yield %':'div_yield_pct','div_yield_pct':'div_yield_pct','eqy_dvd_yld_ind':'div_yield_pct','dividend yield':'div_yield_pct',
        };
        function normCol(h) { return COL_NORM[h.toLowerCase().trim()] || h.toLowerCase().trim().replace(/[\s\/()$%]+/g,'_').replace(/_+$/,''); }

        let raw;
        if (headerIdx >= 0) {
          const headers = allRows[headerIdx].map(h => normCol(String(h)));
          raw = allRows.slice(headerIdx + 1)
            .filter(row => row.some(c => c !== '' && c !== undefined && c !== null))
            .map(row => {
              const obj = {};
              headers.forEach((h, ci) => { if (h) obj[h] = row[ci] !== undefined ? row[ci] : ''; });
              return obj;
            });
        } else {
          /* Fallback: standard parse then normalise keys */
          const fallback = XLSX.utils.sheet_to_json(ws, {defval:''});
          raw = fallback.map(r => {
            const obj = {};
            Object.entries(r).forEach(([k,v]) => { obj[normCol(k)] = v; });
            return obj;
          });
        }

        /* Filter out hint/subtitle rows (row 5 in template has BBG field names) */
        raw = raw.filter(r => {
          const tick = (r.bbg_ticker || '').toString().trim();
          return tick && !tick.startsWith('â†') && !tick.startsWith('â†‘') && !tick.includes('auto-populates') && tick.length > 1;
        });

        if (!raw.length) { setError('No data rows found â€” check sheet has data with a ticker column (BBG Ticker, ticker, etc)'); setParsing(false); return; }

        /* Parse and normalise */
        const tickerMap = buildTickerMap(operators);

        /* Build base ticker index: "NAS.OL" â†’ baseTicker "NAS", "0700.HK" â†’ "700" etc */
        const baseIndex = {};
        operators.forEach(op => {
          op.stocks.forEach(s => {
            const base = s.ticker.replace(/\.[A-Z]+$/i,'').replace(/^0+/,'').toUpperCase();
            if (!baseIndex[base]) baseIndex[base] = [];
            baseIndex[base].push({ opId: op.id, ticker: s.ticker });
          });
        });

        /* Extract base from BBG ticker: "NAS NO Equity" â†’ "NAS", "0700 HK Equity" â†’ "700" */
        function bbgBase(t) {
          return t.replace(/\s+(Equity|Index)$/i,'').replace(/\//g,'').split(/\s+/)[0].replace(/^0+/,'').toUpperCase();
        }

        const parsed = raw
          .filter(r => r.bbg_ticker)
          .map(r => {
            const bbg = (r.bbg_ticker || '').toString().trim();
            const price = parseFloat(r.price || 0);
            const mktCap = parseFloat(r.mkt_cap_m || 0);
            const row = {
              bbg_ticker: bbg,
              name: (r.name || '').toString().trim(),
              country: (r.country || '').toString().trim(),
              gics_sector: (r.gics_sector || '').toString().trim(),
              gics_industry: (r.gics_industry || '').toString().trim(),
              ccy: (r.ccy || '').toString().trim(),
              mkt_cap_m: mktCap,
              price: price,
              fwd_pe: parseFloat(r.fwd_pe || 0),
              trail_pe: parseFloat(r.trail_pe || 0),
              fwd_ev_ebitda: parseFloat(r.fwd_ev_ebitda || 0),
              pb: parseFloat(r.pb || 0),
              ev_sales: parseFloat(r.ev_sales || 0),
              roe_pct: parseFloat(r.roe_pct || 0),
              op_margin_pct: parseFloat(r.op_margin_pct || 0),
              net_margin_pct: parseFloat(r.net_margin_pct || 0),
              fcf_per_sh: parseFloat(r.fcf_per_sh || 0),
              chg_52w_pct: parseFloat(r.chg_52w_pct || 0),
              eps_rev_3m_pct: parseFloat(r.eps_rev_3m_pct || 0),
              beta: parseFloat(r.beta || 0),
              nd_ebitda: parseFloat(r.nd_ebitda || 0),
              div_yield_pct: parseFloat(r.div_yield_pct || 0),
            };

            /* === 3-LAYER TICKER MATCHING === */
            let directMatch = null;

            /* Layer 1: Forward map (normalised exchange codes) */
            const normBbg = normTicker(bbg);
            directMatch = tickerMap[normBbg] || null;

            /* Layer 2: Reverse BBGâ†’XA conversion */
            if (!directMatch) {
              const xaCandidates = bbgToXA(bbg);
              for (const candidate of xaCandidates) {
                const upper = candidate.toUpperCase();
                for (const op of operators) {
                  const found = op.stocks.find(s => s.ticker.toUpperCase() === upper);
                  if (found) { directMatch = { opId: op.id, ticker: found.ticker }; break; }
                }
                if (directMatch) break;
              }
            }

            /* Layer 3: Base ticker match (NAS NO Equity â†’ NAS â†’ NAS.OL) */
            if (!directMatch) {
              const base = bbgBase(bbg);
              const candidates = baseIndex[base];
              if (candidates && candidates.length === 1) {
                directMatch = candidates[0]; /* Unique match */
              } else if (candidates && candidates.length > 1) {
                /* Multiple XA stocks share base ticker â€” disambiguate by country/exchange */
                const exchPart = bbg.replace(/\s+(Equity|Index)$/i,'').split(/\s+/)[1] || '';
                const xaSuffix = (BBG_TO_XA[exchPart.toUpperCase()] || [''])[0];
                const refined = candidates.find(c => c.ticker.toUpperCase().endsWith(xaSuffix.toUpperCase()));
                if (refined) directMatch = refined;
                else directMatch = candidates[0]; /* Best guess */
              }
            }

            /* Find ALL operators this stock appears in */
            let matchedOps = [];
            if (directMatch) {
              const matchTicker = directMatch.ticker.toUpperCase();
              matchedOps = operators.filter(op => op.stocks.some(s => s.ticker.toUpperCase() === matchTicker)).map(op => op.id);
              if (!matchedOps.length) matchedOps = [directMatch.opId];
            }
            row.matched_ops = matchedOps.length ? matchedOps : matchOperators(row);
            row.matched_ticker = directMatch?.ticker || null;
            row.is_direct_match = !!directMatch;

            return row;
          })
          .filter(r => r.price > 0);

        /* Apply $1bn filter */
        const filtered = parsed.filter(r => !r.mkt_cap_m || r.mkt_cap_m >= 1000);

        /* Update operator stock prices from direct matches */
        let priceUpdates = 0;
        const priceMap = {};
        filtered.forEach(r => {
          if (r.is_direct_match && r.matched_ticker) {
            priceMap[r.matched_ticker] = r.price;
            priceUpdates++;
          }
        });

        /* Track unmatched operator stocks */
        const allOpStocks = operators.flatMap(op => op.stocks.map(s => ({ticker: s.ticker, name: s.name, opName: op.name})));
        const unmatched = allOpStocks.filter(s => !priceMap[s.ticker]);

        /* Debug: log matching stats to console */
        console.log(`[XA Data Hub] Parsed: ${parsed.length}, Filtered: ${filtered.length}, Price matches: ${priceUpdates}/${allOpStocks.length}`);
        if (unmatched.length) console.log('[XA Data Hub] Unmatched:', unmatched.map(s => s.ticker).join(', '));

        const snapDate = new Date().toISOString().slice(0,10);
        const newSnap = {
          date: snapDate,
          fileName: file.name,
          totalParsed: parsed.length,
          totalFiltered: filtered.length,
          priceUpdates,
          priceMap,
          unmatched,
          universe: filtered,
        };

        setSnapData(newSnap);
        LS.set('xa_snap_v3', newSnap);
        setParsing(false);
      } catch(err) {
        setError('Parse error: ' + err.message);
        setParsing(false);
      }
    };
    reader.readAsArrayBuffer(file);
  };

  const handleDrop = (e) => { e.preventDefault(); setDragOver(false); if (e.dataTransfer.files[0]) parseFile(e.dataTransfer.files[0]); };
  const handleDragOver = (e) => { e.preventDefault(); setDragOver(true); };
  const handleDragLeave = () => setDragOver(false);
  const handleClick = () => fileRef.current?.click();
  const handleFileInput = (e) => { if (e.target.files[0]) parseFile(e.target.files[0]); };
  const clearSnap = () => { if(confirm('Clear universe data?')){ setSnapData(null); localStorage.removeItem('xa_snap_v3'); }};

  /* Coverage stats per operator */
  const opCoverage = useMemo(() => {
    if (!snapData?.universe) return {};
    const cov = {};
    operators.forEach(op => { cov[op.id] = { total: 0, matched: 0, names: [] }; });
    snapData.universe.forEach(r => {
      r.matched_ops.forEach(opId => {
        if (cov[opId]) { cov[opId].total++; cov[opId].names.push(r); }
        if (r.is_direct_match && cov[opId]) cov[opId].matched++;
      });
    });
    return cov;
  }, [snapData, operators]);

  /* Filtered + sorted universe for table */
  const displayData = useMemo(() => {
    if (!snapData?.universe) return [];
    let d = [...snapData.universe];
    if (opFilter !== 'all') d = d.filter(r => r.matched_ops.includes(opFilter));
    if (searchQ) { const q = searchQ.toLowerCase(); d = d.filter(r => r.name.toLowerCase().includes(q) || r.bbg_ticker.toLowerCase().includes(q) || r.country.toLowerCase().includes(q)); }
    d.sort((a,b) => {
      const av = a[sortCol] || 0, bv = b[sortCol] || 0;
      if (typeof av === 'string') return sortDir === 'asc' ? av.localeCompare(bv) : bv.localeCompare(av);
      return sortDir === 'asc' ? av - bv : bv - av;
    });
    return d.slice(0, 200); /* Cap display at 200 for performance */
  }, [snapData, opFilter, searchQ, sortCol, sortDir]);

  const toggleSort = (col) => {
    if (sortCol === col) setSortDir(sortDir === 'asc' ? 'desc' : 'asc');
    else { setSortCol(col); setSortDir('desc'); }
  };

  const fmt = (v, dp=1) => v ? (typeof v === 'number' ? v.toFixed(dp) : v) : 'â€”';
  const fmtK = (v) => v >= 1e6 ? (v/1e6).toFixed(0)+'T' : v >= 1e3 ? (v/1e3).toFixed(0)+'B' : v ? v.toFixed(0)+'M' : 'â€”';

  return <div style={{padding:32,maxWidth:1400,margin:'0 auto',animation:'fadeIn .3s ease'}}>
    <h1 style={{fontSize:28,fontFamily:'var(--serif)',color:'var(--y)',fontWeight:400,marginBottom:6}}>Data Hub</h1>
    <p style={{fontSize:12,color:'var(--fg4)',marginBottom:28}}>Bloomberg universe upload Â· Friday COB snap Â· Operator screening</p>

    {/* Upload zone */}
    <div
      onDrop={handleDrop} onDragOver={handleDragOver} onDragLeave={handleDragLeave} onClick={handleClick}
      style={{
        border: `2px dashed ${dragOver ? 'var(--g)' : 'var(--border2)'}`,
        borderRadius: 8, padding: 40, textAlign: 'center', cursor: 'pointer',
        background: dragOver ? 'rgba(0,230,118,.04)' : 'var(--bg1)',
        transition: 'all .2s', marginBottom: 24,
      }}>
      <input ref={fileRef} type="file" accept=".xlsx,.xls,.csv" onChange={handleFileInput} style={{display:'none'}}/>
      {parsing ? <div style={{color:'var(--y)',fontFamily:'var(--mono)',fontSize:13}}>â³ Parsing universe...</div> :
        <div>
          <div style={{fontSize:28,marginBottom:8}}>{dragOver ? 'ğŸ“¥' : 'ğŸ“Š'}</div>
          <div style={{fontSize:13,color:'var(--fg)',fontFamily:'var(--mono)',marginBottom:4}}>Drop xa_universe_YYYYMMDD.xlsx here</div>
          <div style={{fontSize:11,color:'var(--fg4)'}}>or click to browse Â· Reads "Upload" sheet Â· Friday COB only</div>
        </div>
      }
    </div>
    {error && <div style={{padding:'10px 16px',background:'rgba(255,61,113,.1)',border:'1px solid rgba(255,61,113,.3)',borderRadius:6,color:'var(--r)',fontSize:12,fontFamily:'var(--mono)',marginBottom:16}}>{error}</div>}

    {/* Snap status */}
    {snapData && <div style={{background:'var(--bg1)',border:'1px solid var(--border2)',borderRadius:8,padding:20,marginBottom:24}}>
      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:16}}>
        <div style={{display:'flex',alignItems:'center',gap:10}}>
          <div style={{width:8,height:8,borderRadius:'50%',background:'var(--g)',boxShadow:'0 0 8px var(--g)'}}/>
          <span style={{fontSize:13,fontFamily:'var(--mono)',fontWeight:700,color:'var(--fg)'}}>Universe Loaded</span>
        </div>
        <button onClick={clearSnap} style={{fontSize:9,fontFamily:'var(--mono)',color:'var(--fg4)',background:'transparent',border:'1px solid var(--border)',borderRadius:3,padding:'3px 8px',cursor:'pointer'}}>Clear</button>
      </div>

      <div style={{display:'grid',gridTemplateColumns:'repeat(5,1fr)',gap:12,marginBottom:20}}>
        {[
          ['File', snapData.fileName, 'var(--fg3)'],
          ['Names', snapData.totalFiltered.toLocaleString() + ' (>$1bn)', 'var(--b)'],
          ['Raw Parsed', snapData.totalParsed.toLocaleString(), 'var(--fg3)'],
          ['Price Matches', snapData.priceUpdates + ' / ' + operators.reduce((a,o)=>a+o.stocks.length,0), 'var(--g)'],
          ['Snap Date', snapData.date, 'var(--y)'],
        ].map(([l,v,c],i) => <div key={i} style={{background:'var(--bg2)',borderRadius:6,padding:'12px 14px'}}>
          <div style={{fontSize:9,fontWeight:700,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase',letterSpacing:'.1em',marginBottom:4}}>{l}</div>
          <div style={{fontSize:14,fontWeight:600,color:c,fontFamily:'var(--mono)'}}>{v}</div>
        </div>)}
      </div>

      {/* Operator coverage grid */}
      <div style={{fontSize:10,fontWeight:700,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase',letterSpacing:'.1em',marginBottom:10}}>Operator Coverage</div>
      <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(180px,1fr))',gap:8,marginBottom:8}}>
        {operators.map(op => {
          const cov = opCoverage[op.id] || {total:0, matched:0};
          return <div key={op.id} style={{background:'var(--bg2)',borderRadius:6,padding:'10px 12px',borderLeft:`3px solid ${op.color}`}}>
            <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:4}}>
              <span style={{fontSize:11,fontWeight:700,color:op.color,fontFamily:'var(--mono)'}}>{op.icon} {op.name}</span>
              <span style={{fontSize:10,color:'var(--fg3)',fontFamily:'var(--mono)'}}>{cov.total} names</span>
            </div>
            <div style={{display:'flex',gap:8,fontSize:9,fontFamily:'var(--mono)',color:'var(--fg4)'}}>
              <span>ğŸ“Œ {cov.matched} matched</span>
              <span>ğŸ” {cov.total - cov.matched} screened</span>
            </div>
          </div>;
        })}
      </div>
    </div>}

    {/* Unmatched tickers â€” shows which operator stocks didn't get a price update */}
    {snapData?.unmatched?.length > 0 && <div style={{background:'var(--bg1)',border:'1px solid rgba(255,61,113,.2)',borderRadius:8,padding:16,marginBottom:24}}>
      <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:10}}>
        <span style={{fontSize:11,fontFamily:'var(--mono)',fontWeight:700,color:'var(--r)'}}>âš  Unmatched Operator Stocks ({snapData.unmatched.length})</span>
        <span style={{fontSize:9,fontFamily:'var(--mono)',color:'var(--fg4)'}}>These names kept their hardcoded prices â€” BBG ticker not found in upload</span>
      </div>
      <div style={{display:'flex',flexWrap:'wrap',gap:4}}>
        {snapData.unmatched.map((s,i) => <span key={i} style={{fontSize:9,fontFamily:'var(--mono)',padding:'2px 6px',borderRadius:3,background:'rgba(255,61,113,.08)',color:'var(--r)',border:'1px solid rgba(255,61,113,.15)'}} title={s.opName + ': ' + s.name}>{s.ticker}</span>)}
      </div>
    </div>}

    {/* Universe browser */}
    {snapData?.universe?.length > 0 && <div style={{background:'var(--bg1)',border:'1px solid var(--border2)',borderRadius:8,overflow:'hidden'}}>
      <div style={{padding:'16px 20px',borderBottom:'1px solid var(--border)',display:'flex',justifyContent:'space-between',alignItems:'center',flexWrap:'wrap',gap:10}}>
        <div style={{fontSize:13,fontFamily:'var(--mono)',fontWeight:700,color:'var(--fg)'}}>Universe Browser</div>
        <div style={{display:'flex',gap:8,alignItems:'center'}}>
          <input value={searchQ} onChange={e=>setSearchQ(e.target.value)} placeholder="Search name / ticker / country..."
            style={{padding:'5px 10px',fontSize:11,fontFamily:'var(--mono)',background:'var(--bg2)',border:'1px solid var(--border)',borderRadius:4,color:'var(--fg)',width:220}}/>
          <select value={opFilter} onChange={e=>setOpFilter(e.target.value)}
            style={{padding:'5px 10px',fontSize:11,fontFamily:'var(--mono)',background:'var(--bg2)',border:'1px solid var(--border)',borderRadius:4,color:'var(--fg)',cursor:'pointer'}}>
            <option value="all">All Operators</option>
            {operators.map(o => <option key={o.id} value={o.id}>{o.icon} {o.name} ({(opCoverage[o.id]||{total:0}).total})</option>)}
          </select>
          <span style={{fontSize:10,color:'var(--fg4)',fontFamily:'var(--mono)'}}>{displayData.length}{displayData.length>=200?'+':''} shown</span>
        </div>
      </div>

      <div style={{overflowX:'auto'}}>
        <table style={{width:'100%',borderCollapse:'collapse',fontSize:10,fontFamily:'var(--mono)'}}>
          <thead>
            <tr style={{background:'var(--bg2)'}}>
              {[
                ['bbg_ticker','Ticker',90],['name','Name',160],['country','Cty',42],['gics_sector','Sector',120],
                ['ccy','Ccy',38],['mkt_cap_m','Mkt Cap',80],['price','Price',72],
                ['fwd_pe','Fwd P/E',60],['fwd_ev_ebitda','EV/EB',60],['pb','P/B',50],
                ['roe_pct','ROE%',55],['op_margin_pct','OpM%',55],['chg_52w_pct','52w%',55],
                ['eps_rev_3m_pct','EPS Rev',60],['nd_ebitda','ND/EB',55],['div_yield_pct','DY%',50],
              ].map(([col,label,w]) => <th key={col} onClick={()=>toggleSort(col)} style={{
                padding:'8px 6px',textAlign:col==='name'||col==='gics_sector'?'left':'right',
                color:sortCol===col?'var(--g)':'var(--fg4)',cursor:'pointer',borderBottom:'1px solid var(--border)',
                fontWeight:700,fontSize:9,letterSpacing:'.04em',whiteSpace:'nowrap',minWidth:w,
              }}>{label} {sortCol===col?(sortDir==='asc'?'â†‘':'â†“'):''}</th>)}
              <th style={{padding:'8px 6px',textAlign:'center',color:'var(--fg4)',borderBottom:'1px solid var(--border)',fontSize:9,fontWeight:700,minWidth:100}}>Operators</th>
            </tr>
          </thead>
          <tbody>
            {displayData.map((r,i) => <tr key={i} style={{borderBottom:'1px solid var(--border)',background:r.is_direct_match?'rgba(0,230,118,.03)':'transparent'}}>
              <td style={{padding:'6px',color:r.is_direct_match?'var(--g)':'var(--fg2)',fontWeight:r.is_direct_match?700:400}}>{r.bbg_ticker}</td>
              <td style={{padding:'6px',color:'var(--fg)',textAlign:'left',maxWidth:160,overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap'}}>{r.name}</td>
              <td style={{padding:'6px',textAlign:'right',color:'var(--fg3)'}}>{r.country}</td>
              <td style={{padding:'6px',textAlign:'left',color:'var(--fg4)',maxWidth:120,overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap'}}>{r.gics_sector}</td>
              <td style={{padding:'6px',textAlign:'right',color:'var(--fg4)'}}>{r.ccy}</td>
              <td style={{padding:'6px',textAlign:'right',color:'var(--fg3)'}}>{fmtK(r.mkt_cap_m)}</td>
              <td style={{padding:'6px',textAlign:'right',color:'var(--fg)',fontWeight:600}}>{fmt(r.price,2)}</td>
              <td style={{padding:'6px',textAlign:'right',color:r.fwd_pe>0&&r.fwd_pe<15?'var(--g)':r.fwd_pe>40?'var(--r)':'var(--fg3)'}}>{r.fwd_pe?fmt(r.fwd_pe)+'x':'â€”'}</td>
              <td style={{padding:'6px',textAlign:'right',color:'var(--fg3)'}}>{r.fwd_ev_ebitda?fmt(r.fwd_ev_ebitda)+'x':'â€”'}</td>
              <td style={{padding:'6px',textAlign:'right',color:'var(--fg3)'}}>{r.pb?fmt(r.pb)+'x':'â€”'}</td>
              <td style={{padding:'6px',textAlign:'right',color:r.roe_pct>15?'var(--g)':'var(--fg3)'}}>{r.roe_pct?fmt(r.roe_pct)+'%':'â€”'}</td>
              <td style={{padding:'6px',textAlign:'right',color:'var(--fg3)'}}>{r.op_margin_pct?fmt(r.op_margin_pct)+'%':'â€”'}</td>
              <td style={{padding:'6px',textAlign:'right',color:r.chg_52w_pct>20?'var(--g)':r.chg_52w_pct<-20?'var(--r)':'var(--fg3)'}}>{r.chg_52w_pct?fmt(r.chg_52w_pct)+'%':'â€”'}</td>
              <td style={{padding:'6px',textAlign:'right',color:r.eps_rev_3m_pct>0?'var(--g)':r.eps_rev_3m_pct<0?'var(--r)':'var(--fg3)'}}>{r.eps_rev_3m_pct?fmt(r.eps_rev_3m_pct)+'%':'â€”'}</td>
              <td style={{padding:'6px',textAlign:'right',color:r.nd_ebitda>3?'var(--r)':'var(--fg3)'}}>{r.nd_ebitda?fmt(r.nd_ebitda)+'x':'â€”'}</td>
              <td style={{padding:'6px',textAlign:'right',color:'var(--fg3)'}}>{r.div_yield_pct?fmt(r.div_yield_pct)+'%':'â€”'}</td>
              <td style={{padding:'6px',textAlign:'center'}}>
                {r.matched_ops.map(opId => {
                  const op = operators.find(o=>o.id===opId);
                  return op ? <span key={opId} title={op.name} style={{display:'inline-block',fontSize:9,padding:'1px 4px',borderRadius:3,marginRight:2,background:`${op.color}15`,color:op.color,border:`1px solid ${op.color}30`}}>{op.icon}</span> : null;
                })}
              </td>
            </tr>)}
          </tbody>
        </table>
      </div>
    </div>}
  </div>;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EXPORT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function ExportView({operators, globalDrivers}) {
  const [scope, setScope] = useState('all');
  const [selOp, setSelOp] = useState(operators[0]?.id||'');
  const [format, setFormat] = useState('csv');

  const doExport = () => {
    const date = new Date().toISOString().slice(0,10);
    const ops = scope === 'all' ? operators : operators.filter(o => o.id === selOp);
    if (format === 'json') {
      download(JSON.stringify({operators: ops.map(o => ({...o, stats: computeOpStats(o, globalDrivers)})), exported: date}, null, 2), `xa_${scope}_${date}.json`, 'application/json');
    } else {
      const h = ['ticker','name','verdict','operator','team','current_price','ev','rr_pct','skew','engine_verdict','tier',...SCENARIOS.map(s=>`price_${s.label.replace(/\s/g,'_')}`)];
      let csv = h.join(',') + '\n';
      ops.forEach(op => {
        op.stocks.forEach(s => {
          const eng = runEngine(s, op.driverMap, globalDrivers);
          csv += [s.ticker, s.name, s.verdict, op.name, op.team, s.currentPrice, eng?.ev?.toFixed(2)||'', eng?.rr?.toFixed(1)||'', eng?.skew?.toFixed(2)||'', eng?.vd||'', eng?.tier||'', ...(s.prices||[]).map(p=>p)].join(',') + '\n';
        });
      });
      download(csv, `xa_${scope}_${date}.csv`);
    }
  };

  const totalS = operators.reduce((a,o) => a + o.stocks.length, 0);

  return <div style={{padding:32,maxWidth:600,margin:'0 auto',animation:'fadeIn .3s ease'}}>
    <h1 style={{fontSize:28,fontFamily:'var(--serif)',color:'var(--b)',fontWeight:400,marginBottom:6}}>Export Centre</h1>
    <p style={{fontSize:12,color:'var(--fg4)',marginBottom:28}}>Export with full engine output for XA-Coach or backup</p>

    <div style={{fontSize:10,fontWeight:700,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase',letterSpacing:'.1em',marginBottom:8}}>Scope</div>
    <div style={{display:'flex',gap:6,marginBottom:20}}>
      {[['all',`All Operators (${totalS})`],['single','Single Operator']].map(([v,l]) =>
        <Btn key={v} active={scope===v} color="var(--b)" onClick={() => setScope(v)} style={{flex:1}}>{l}</Btn>)}
    </div>
    {scope==='single' && <div style={{marginBottom:20}}>
      <select value={selOp} onChange={e => setSelOp(e.target.value)} style={{width:'100%',padding:'8px 12px',fontSize:12,fontFamily:'var(--mono)',background:'var(--bg2)',border:'1px solid var(--border)',borderRadius:4,color:'var(--fg)',cursor:'pointer'}}>
        {operators.map(o => <option key={o.id} value={o.id}>{o.name} â€” {o.team} ({o.stocks.length})</option>)}
      </select>
    </div>}

    <div style={{fontSize:10,fontWeight:700,color:'var(--fg4)',fontFamily:'var(--mono)',textTransform:'uppercase',letterSpacing:'.1em',marginBottom:8}}>Format</div>
    <div style={{display:'flex',gap:6,marginBottom:24}}>
      <Btn active={format==='csv'} color="var(--g)" onClick={() => setFormat('csv')} style={{flex:1}}>CSV (XA-Coach)</Btn>
      <Btn active={format==='json'} color="var(--p)" onClick={() => setFormat('json')} style={{flex:1}}>JSON (Full Backup)</Btn>
    </div>
    <button onClick={doExport} style={{width:'100%',padding:'14px',fontSize:14,fontFamily:'var(--mono)',fontWeight:700,borderRadius:6,cursor:'pointer',border:'none',background:'var(--b)',color:'#000',transition:'all .2s'}}>â†“ Export</button>
  </div>;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIN APP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function App() {
  const [view, setView] = useState('overview');

  // Build flat global drivers from all operators
  const defaultDrivers = OPERATORS.flatMap(op => op.drivers.map(d => ({...d, opId: op.id})));
  const [globalDrivers, setGlobalDrivers] = useState(() => LS.get('xa_drivers_v2') || defaultDrivers);
  const [snapData, setSnapData] = useState(() => LS.get('xa_snap_v3') || null);

  useEffect(() => { LS.set('xa_drivers_v2', globalDrivers); }, [globalDrivers]);

  /* Apply snap prices to operator stocks */
  const liveOperators = useMemo(() => {
    if (!snapData?.priceMap) return OPERATORS;
    return OPERATORS.map(op => ({
      ...op,
      stocks: op.stocks.map(s => ({
        ...s,
        currentPrice: snapData.priceMap[s.ticker] || s.currentPrice,
      }))
    }));
  }, [snapData]);

  const handleReset = () => {
    if (confirm('Reset all macro signals to defaults?')) {
      localStorage.removeItem('xa_drivers_v2');
      setGlobalDrivers(defaultDrivers);
    }
  };

  let content;
  if (view === 'overview') content = <OverviewView operators={liveOperators} globalDrivers={globalDrivers}/>;
  else if (view === 'macro') content = <MacroView operators={liveOperators} globalDrivers={globalDrivers} setGlobalDrivers={setGlobalDrivers}/>;
  else if (view === 'operators') content = <OperatorsView operators={liveOperators} globalDrivers={globalDrivers}/>;
  else if (view === 'data') content = <DataView operators={liveOperators} globalDrivers={globalDrivers} snapData={snapData} setSnapData={setSnapData}/>;
  else if (view === 'export') content = <ExportView operators={liveOperators} globalDrivers={globalDrivers}/>;

  return <div style={{display:'flex',flexDirection:'column',height:'100vh'}}>
    <Header view={view} setView={setView}/>
    <div style={{flex:1,overflowY:'auto',position:'relative'}}>
      <div style={{position:'absolute',top:10,right:16,zIndex:10,display:'flex',gap:8,alignItems:'center'}}>
        {snapData && <span style={{fontSize:9,fontFamily:'var(--mono)',color:'var(--g)',opacity:.7}}>ğŸ“Š Snap: {snapData.date}</span>}
        <button onClick={handleReset} title="Reset signals" style={{background:'transparent',border:'1px solid var(--border)',borderRadius:4,color:'var(--fg4)',cursor:'pointer',padding:'4px 8px',fontSize:9,fontFamily:'var(--mono)'}}>Reset Signals</button>
      </div>
      {content}
    </div>
    <div style={{borderTop:'1px solid var(--border)',padding:'8px 28px',display:'flex',justifyContent:'space-between',alignItems:'center',background:'var(--bg1)',flexShrink:0}}>
      <span style={{fontSize:9,color:'var(--fg4)',fontFamily:'var(--mono)'}}>XA Command Centre v3.0 â€” GRS Â· Pan Asian Thematic</span>
      <span style={{fontSize:9,color:'var(--fg4)',fontFamily:'var(--mono)'}}>upside-xa.com</span>
    </div>
  </div>;
}

ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
</script>
</body>
</html>
